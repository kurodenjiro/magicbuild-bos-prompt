[["0",{"pageContent":"---\nid: overview\ntitle: Overview\n---\n\nNEAR simplifies building, deploying and accessing decentralized frontends. Embrace the power of community and Web 3.\n\n![bos](/docs/bos-landing.png)\n\n---","metadata":{"loc":{"lines":{"from":1,"to":10}}}}],["1",{"pageContent":"## Why Using NEAR Tech Stack?\n\nNEAR is more than just a blockchain, it is also a development environment and a platform in which to deploy and discover new applications. NEAR simplifies building Web 3 applications providing easy onboarding, high security and a seamless interaction with all chains.\n\n#### Access \nWith NEAR, users always have the ability to locally run blockchain applications which helps assure robustness and censorship-resistance, while maintaining a user-friendly experience.","metadata":{"loc":{"lines":{"from":12,"to":17}}}}],["2",{"pageContent":"#### Security\nThe code for Components is always on-chain, making it auditable and viewable in explorers. This enhances security, and users can locally run the full stack with confidence. \n\n#### Composability\nNEAR fosters composability by enabling developers to reuse and remix Components. Building with NEAR is extremely lightweight and easy, with the ability to deploy new front-ends for smart contracts on mainnet in less than 10 minutes.","metadata":{"loc":{"lines":{"from":19,"to":23}}}}],["3",{"pageContent":"#### Chain Agnostic Components\nAdditionally, NEAR Components are chain-agnostic, making it a flexible solution for developers working with different blockchains.\n\n---","metadata":{"loc":{"lines":{"from":25,"to":28}}}}],["4",{"pageContent":"## The Pillars of NEAR Stack\n\nThe NEAR stack is based on three pillars: \n- Components: Composable frontends that solve specific problems.\n- [Blockchains](#blockchains): To store the component's code, as well as their assets and data.\n- [Gateways](#gateways): A simple way to render components anywhere.\n\n<hr className=\"subsection\" />","metadata":{"loc":{"lines":{"from":30,"to":37}}}}],["5",{"pageContent":"### Components\n\nComponents are small web 3 applications (think [Lido](tutorial/hello-lido.md), Uniswap, Aave) that are stored **entirely on-chain**.\n\nDevelopers can fork these apps and compose them to create full web applications.\n\n<hr className=\"subsection\" />","metadata":{"loc":{"lines":{"from":39,"to":45}}}}],["6",{"pageContent":"### Blockchains\n\nComponents can call functions on any blockchain, with current support for all EVM chains (e.g. Polygon, zkSync) and NEAR.\n\nThe source code for the apps is on NEAR, due to it's ability to very cheaply store HTML/CSS/JS (a few cents).\n\n<hr className=\"subsection\" />","metadata":{"loc":{"lines":{"from":47,"to":53}}}}],["7",{"pageContent":"### Gateways\n\nGateways make locally-run, decentralized front-ends available to the masses. A gateway consists of a specially designed virtual machine that loads and runs frontends for protocols built on Ethereum, L2s, and other Layer 1s like NEAR. The code for these frontends is stored on the NEAR blockchain.","metadata":{"loc":{"lines":{"from":55,"to":57}}}}],["8",{"pageContent":"Examples of gateways include [near.org](https://near.org), [bos.gg](https://bos.gg), [near.social](https://near.social), [Cantopia](https://cantopia.pages.dev), and [nearpad.dev](https://nearpad.dev).","metadata":{"loc":{"lines":{"from":59,"to":59}}}}],["9",{"pageContent":"---\nid: quickstart\ntitle: What are NEAR Components?\nsidebar_label: What is a Component?\n---\n\nimport Tabs from '@theme/Tabs';\nimport TabItem from '@theme/TabItem';\nimport {WidgetEditor} from \"@site/src/components/widget-editor\"\n\nNEAR Components are a new way to build web applications. They are composable, reusable and decentralized.\n\n![img](/docs/assets/welcome-pages/bos-landing.png)\n\n:::tip\nYou can login to interact with the examples in this section.\n:::\n\n---","metadata":{"loc":{"lines":{"from":1,"to":19}}}}],["10",{"pageContent":"## Familiar to Web Developers\nNEAR Components are built on top of [React Components](https://react.dev/), meaning that they:\n- Handle input through the `props` variable\n- Handle state through the [`useState`](https://react.dev/reference/react/useState) hook\n- Handle side effects through the [`useEffect`](https://react.dev/reference/react/useEffect) hook\n\n<WidgetEditor id=\"1\">\n\n```jsx\nconst name = props.name || \"Maria\";\nconst [count, setCount] = useState(1);","metadata":{"loc":{"lines":{"from":21,"to":31}}}}],["11",{"pageContent":"return (\n  <div>\n    <p> {count} cheers for {name}! </p>\n    <button onClick={() => setCount(count + 1)}>Cheers!</button>\n  </div>\n);","metadata":{"loc":{"lines":{"from":33,"to":38}}}}],["12",{"pageContent":"```\n\n</WidgetEditor>\n\nIn contrast with React, NEAR Components are not wrapped in a `function` or `class` definition.\n\nIndeed, when writing a NEAR Component, you focus on writing the body of the component, which is a function that returns the JSX to be rendered. \n\n---","metadata":{"loc":{"lines":{"from":39,"to":47}}}}],["13",{"pageContent":"## NEAR Native\nNEAR Components can readily [interact with smart contracts](../api/near.md) in the NEAR Blockchain. While `view` methods are free to query by anyone, `call` methods require the user to be logged in.\n\n<WidgetEditor id=\"2\">\n\n```jsx\nconst counter = Near.view('counter.near-examples.testnet', 'get_num')\n\nif(counter === null) return 'Loading...'\n\nconst add = () => {\n  Near.call('counter.near-examples.testnet', 'increment')\n}","metadata":{"loc":{"lines":{"from":49,"to":61}}}}],["14",{"pageContent":"const subtract = () => {\n  Near.call('counter.near-examples.testnet', 'decrement')\n}\n\nreturn <>\n  <p> Counter: {counter} </p>\n  {!context.accountId &&\n    <p color=\"red\"> Please login to interact with the contract</p>\n  }\n  {context.accountId && \n  <>\n    <button onClick={add}> + </button>\n    <button onClick={subtract}> - </button>\n  </>\n  }\n</>","metadata":{"loc":{"lines":{"from":63,"to":78}}}}],["15",{"pageContent":"```\n\n</WidgetEditor>\n\n---","metadata":{"loc":{"lines":{"from":79,"to":83}}}}],["16",{"pageContent":"## Social from the Get-Go\n\nNEAR Components are easily integrated with [NEAR Social](https://near.social/), a social network built on NEAR.\n\n<WidgetEditor id=\"3\">\n\n```js\nconst item = (blockHeight) => ({ type: 'social', path: 'influencer.testnet/post/main', blockHeight });\n\n// retrieve indexed posts by influencer.testnet\nconst idx_posts = Social.index(\n  'post', 'main', { accountId: ['influencer.testnet'] }\n);\n\nif (idx_posts === null) return 'Loading...';","metadata":{"loc":{"lines":{"from":85,"to":99}}}}],["17",{"pageContent":"// retrieve likes for each post\nconst likes = idx_posts.map(\n  index => Social.index('like', item(index.blockHeight)).length\n);\n\n// retrieve data for each post\nconst post_data = idx_posts.map(\n  index => Social.get(`${index.accountId}/post/main`, index.blockHeight)\n);\n\n// defined \"Like\" function\nconst like = (blockHeight) => Social.set(\n  {index:{like: JSON.stringify({key: item(blockHeight), value: {type: 'like'}})}}\n)","metadata":{"loc":{"lines":{"from":101,"to":114}}}}],["18",{"pageContent":"return <>\n  <h5>Posts from <i>influencer.testnet</i></h5>\n  {post_data.map((post, idx) =>\n    <div className=\"mt-3\">\n      <div>{JSON.parse(post).text} - {likes[idx]} likes</div>\n      {context.accountId && <button className=\"btn btn-danger btn-sm\" onClick={() => like(idx_posts[idx].blockHeight)}>Like</button>}\n    </div>\n  )}\n</>","metadata":{"loc":{"lines":{"from":116,"to":124}}}}],["19",{"pageContent":"```\n\n</WidgetEditor>\n\n---","metadata":{"loc":{"lines":{"from":126,"to":130}}}}],["20",{"pageContent":"## Fully On-Chain & Easily Composable\n\nLeveraging the cheap storage and computation of the NEAR Blockchain, NEAR Components' code is stored fully on-chain in the SocialDB smart contract (`social.near`).\n\n<WidgetEditor height=\"40px\">\n\n```js\n// retrieving the code of a stored component\nreturn Social.get('influencer.testnet/widget/Greeter')","metadata":{"loc":{"lines":{"from":132,"to":140}}}}],["21",{"pageContent":"```\n\n</WidgetEditor>\n\nOnce deployed, a component can be imported and used by any other component. Composing components as LEGO blocks allows you to build complex applications.\n\n<WidgetEditor id=\"4\" height=\"80px\">\n\n```js\n// Rendering the component with props\nreturn <Widget src=\"influencer.testnet/widget/Greeter\"\n               props={{name: \"Anna\", amount: 3}} />;\n```\n</WidgetEditor>\n\n---","metadata":{"loc":{"lines":{"from":141,"to":156}}}}],["22",{"pageContent":"## Multi-Chain by Design\n\nNEAR Components can easily interact with Ethereum compatible blockchains, helping to easily create decentralized frontends for multi-chain applications.\n\n<WidgetEditor id=\"5\" height=\"100px\">","metadata":{"loc":{"lines":{"from":158,"to":162}}}}],["23",{"pageContent":"```js\nif (\n  state.chainId === undefined &&\n  ethers !== undefined &&\n  Ethers.send(\"eth_requestAccounts\", [])[0]\n) {\n  Ethers.provider()\n    .getNetwork()\n    .then((chainIdData) => {\n      if (chainIdData?.chainId) {\n        State.update({ chainId: chainIdData.chainId });\n      }\n    });\n}\nif (state.chainId !== undefined && state.chainId !== 1) {\n  return <p>Switch to Ethereum Mainnet</p>;\n}\n\n// FETCH LIDO ABI","metadata":{"loc":{"lines":{"from":164,"to":182}}}}],["24",{"pageContent":"const lidoContract = \"0xae7ab96520de3a18e5e111b5eaab095312d7fe84\";\nconst tokenDecimals = 18;\n\nconst lidoAbi = fetch(\n  \"https://raw.githubusercontent.com/lidofinance/lido-subgraph/master/abis/Lido.json\"\n);\nif (!lidoAbi.ok) {\n  return \"Loading\";\n}\n\nconst iface = new ethers.utils.Interface(lidoAbi.body);\n\n// FETCH LIDO STAKING APR","metadata":{"loc":{"lines":{"from":184,"to":196}}}}],["25",{"pageContent":"if (state.lidoArp === undefined) {\n  const apr = fetch(\n    \"https://api.allorigins.win/get?url=https://stake.lido.fi/api/sma-steth-apr\"\n  );\n  if (!apr) return;\n  State.update({ lidoArp: JSON.parse(apr?.body?.contents) ?? \"...\" });\n}\n\n// HELPER FUNCTIONS\n\nconst getStakedBalance = (receiver) => {\n  const encodedData = iface.encodeFunctionData(\"balanceOf\", [receiver]);","metadata":{"loc":{"lines":{"from":198,"to":209}}}}],["26",{"pageContent":"return Ethers.provider()\n    .call({\n      to: lidoContract,\n      data: encodedData,\n    })\n    .then((rawBalance) => {\n      const receiverBalanceHex = iface.decodeFunctionResult(\n        \"balanceOf\",\n        rawBalance\n      );\n\n      return Big(receiverBalanceHex.toString())\n        .div(Big(10).pow(tokenDecimals))\n        .toFixed(2)\n        .replace(/\\d(?=(\\d{3})+\\.)/g, \"$&,\");\n    });\n};","metadata":{"loc":{"lines":{"from":211,"to":227}}}}],["27",{"pageContent":"const submitEthers = (strEther, _referral) => {\n  if (!strEther) {\n    return console.log(\"Amount is missing\");\n  }\n  const erc20 = new ethers.Contract(\n    lidoContract,\n    lidoAbi.body,\n    Ethers.provider().getSigner()\n  );\n\n  let amount = ethers.utils.parseUnits(strEther, tokenDecimals).toHexString();\n\n  erc20.submit(lidoContract, { value: amount }).then((transactionHash) => {\n    console.log(\"transactionHash is \" + transactionHash);\n  });\n};\n\n// DETECT SENDER","metadata":{"loc":{"lines":{"from":229,"to":246}}}}],["28",{"pageContent":"if (state.sender === undefined) {\n  const accounts = Ethers.send(\"eth_requestAccounts\", []);\n  if (accounts.length) {\n    State.update({ sender: accounts[0] });\n    console.log(\"set sender\", accounts[0]);\n  }\n}\n\n//if (!state.sender)  return \"Please login first\";\n\n// FETCH SENDER BALANCE","metadata":{"loc":{"lines":{"from":248,"to":258}}}}],["29",{"pageContent":"if (state.balance === undefined && state.sender) {\n  Ethers.provider()\n    .getBalance(state.sender)\n    .then((balance) => {\n      State.update({ balance: Big(balance).div(Big(10).pow(18)).toFixed(2) });\n    });\n}\n\n// FETCH SENDER STETH BALANCE\n\nif (state.stakedBalance === undefined && state.sender) {\n  getStakedBalance(state.sender).then((stakedBalance) => {\n    State.update({ stakedBalance });\n  });\n}\n\n// FETCH TX COST","metadata":{"loc":{"lines":{"from":260,"to":276}}}}],["30",{"pageContent":"if (state.txCost === undefined) {\n  const gasEstimate = ethers.BigNumber.from(1875000);\n  const gasPrice = ethers.BigNumber.from(1500000000);\n\n  const gasCostInWei = gasEstimate.mul(gasPrice);\n  const gasCostInEth = ethers.utils.formatEther(gasCostInWei);","metadata":{"loc":{"lines":{"from":278,"to":283}}}}],["31",{"pageContent":"let responseGql = fetch(\n    \"https://api.thegraph.com/subgraphs/name/uniswap/uniswap-v2\",\n    {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({\n        query: `{\n          bundle(id: \"1\" ) {\n            ethPrice\n          }\n        }`,\n      }),\n    }\n  );\n\n  if (!responseGql) return \"\";\n\n  const ethPriceInUsd = responseGql.body.data.bundle.ethPrice;\n\n  const txCost = Number(gasCostInEth) * Number(ethPriceInUsd);","metadata":{"loc":{"lines":{"from":285,"to":304}}}}],["32",{"pageContent":"State.update({ txCost: `$${txCost.toFixed(2)}` });\n}\n\n// FETCH CSS\n\nconst cssFont = fetch(\n  \"https://fonts.googleapis.com/css2?family=Manrope:wght@200;300;400;500;600;700;800\"\n).body;\nconst css = fetch(\n  \"https://pluminite.mypinata.cloud/ipfs/Qmboz8aoSvVXLeP5pZbRtNKtDD3kX5D9DEnfMn2ZGSJWtP\"\n).body;\n\nif (!cssFont || !css) return \"\";","metadata":{"loc":{"lines":{"from":306,"to":318}}}}],["33",{"pageContent":"if (!state.theme) {\n  State.update({\n    theme: styled.div`\n    font-family: Manrope, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;\n    ${cssFont}\n    ${css}\n`,\n  });\n}\nconst Theme = state.theme;\n\n// OUTPUT UI\n\nconst getSender = () => {\n  return !state.sender\n    ? \"\"\n    : state.sender.substring(0, 6) +\n        \"...\" +\n        state.sender.substring(state.sender.length - 4, state.sender.length);\n};","metadata":{"loc":{"lines":{"from":320,"to":339}}}}],["34",{"pageContent":"return (\n  <Theme>\n    <div className=\"LidoContainer\">\n      <div className=\"Header\">Stake Ether</div>\n      <div className=\"SubHeader\">Stake ETH and receive stETH while staking.</div>","metadata":{"loc":{"lines":{"from":341,"to":345}}}}],["35",{"pageContent":"<div className=\"LidoForm\">\n        {state.sender && (\n          <>\n            <div className=\"LidoFormTopContainer\">\n              <div className=\"LidoFormTopContainerLeft\">\n                <div className=\"LidoFormTopContainerLeftContent1\">\n                  <div className=\"LidoFormTopContainerLeftContent1Container\">\n                    <span>Available to stake</span>\n                    <div className=\"LidoFormTopContainerLeftContent1Circle\" />\n                  </div>","metadata":{"loc":{"lines":{"from":347,"to":356}}}}],["36",{"pageContent":"</div>\n                <div className=\"LidoFormTopContainerLeftContent2\">\n                  <span>\n                    {state.balance ?? (!state.sender ? \"0\" : \"...\")}&nbsp;ETH\n                  </span>\n                </div>\n              </div>\n              <div className=\"LidoFormTopContainerRight\">\n                <div className=\"LidoFormTopContainerRightContent1\">\n                  <div className=\"LidoFormTopContainerRightContent1Text\">","metadata":{"loc":{"lines":{"from":357,"to":366}}}}],["37",{"pageContent":"<span>{getSender()}</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div className=\"LidoSplitter\" />\n          </>\n        )}\n        <div\n          className={\n            state.sender ? \"LidoFormBottomContainer\" : \"LidoFormTopContainer\"\n          }\n        >\n          <div className=\"LidoFormTopContainerLeft\">\n            <div className=\"LidoFormTopContainerLeftContent1\">","metadata":{"loc":{"lines":{"from":367,"to":381}}}}],["38",{"pageContent":"<div className=\"LidoFormTopContainerLeftContent1Container\">\n                <span>Staked amount</span>\n              </div>\n            </div>\n            <div className=\"LidoFormTopContainerLeftContent2\">\n              <span>\n                {state.stakedBalance ?? (!state.sender ? \"0\" : \"...\")}\n                &nbsp;stETH\n              </span>\n            </div>\n          </div>\n          <div className=\"LidoFormTopContainerRight\">\n            <div className=\"LidoAprContainer\">","metadata":{"loc":{"lines":{"from":382,"to":394}}}}],["39",{"pageContent":"<div className=\"LidoAprTitle\">Lido APR</div>\n              <div className=\"LidoAprValue\">{state.lidoArp ?? \"...\"}%</div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div className=\"LidoStakeForm\">\n        <div className=\"LidoStakeFormInputContainer\">\n          <span className=\"LidoStakeFormInputContainerSpan1\">\n            <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n              <path\n                opacity=\"0.6\"","metadata":{"loc":{"lines":{"from":395,"to":406}}}}],["40",{"pageContent":"d=\"M11.999 3.75v6.098l5.248 2.303-5.248-8.401z\"\n              ></path>\n              <path d=\"M11.999 3.75L6.75 12.151l5.249-2.303V3.75z\"></path>\n              <path\n                opacity=\"0.6\"\n                d=\"M11.999 16.103v4.143l5.251-7.135L12 16.103z\"\n              ></path>\n              <path d=\"M11.999 20.246v-4.144L6.75 13.111l5.249 7.135z\"></path>\n              <path\n                opacity=\"0.2\"\n                d=\"M11.999 15.144l5.248-2.993-5.248-2.301v5.294z\"","metadata":{"loc":{"lines":{"from":407,"to":417}}}}],["41",{"pageContent":"></path>\n              <path\n                opacity=\"0.6\"\n                d=\"M6.75 12.151l5.249 2.993V9.85l-5.249 2.3z\"\n              ></path>\n            </svg>\n          </span>\n          <span className=\"LidoStakeFormInputContainerSpan2\">\n            <input\n              disabled={!state.sender}\n              className=\"LidoStakeFormInputContainerSpan2Input\"\n              value={state.strEther}\n              onChange={(e) => State.update({ strEther: e.target.value })}","metadata":{"loc":{"lines":{"from":418,"to":430}}}}],["42",{"pageContent":"placeholder=\"Amount\"\n            />\n          </span>\n          <span\n            className=\"LidoStakeFormInputContainerSpan3\"\n            onClick={() => {\n              State.update({\n                strEther: (state.balance > 0.05\n                  ? parseFloat(state.balance) - 0.05\n                  : 0\n                ).toFixed(2),\n              });\n            }}\n          >\n            <button\n              className=\"LidoStakeFormInputContainerSpan3Content\"","metadata":{"loc":{"lines":{"from":431,"to":446}}}}],["43",{"pageContent":"disabled={!state.sender}\n            >\n              <span className=\"LidoStakeFormInputContainerSpan3Max\">MAX</span>\n            </button>\n          </span>\n        </div>\n        {!!state.sender ? (\n          <button\n            className=\"LidoStakeFormSubmitContainer\"\n            onClick={() => submitEthers(state.strEther, state.sender)}\n          >\n            <span>Submit</span>\n          </button>\n        ) : (\n          <Web3Connect","metadata":{"loc":{"lines":{"from":447,"to":461}}}}],["44",{"pageContent":"className=\"LidoStakeFormSubmitContainer\"\n            connectLabel=\"Connect with Web3\"\n          />\n        )}","metadata":{"loc":{"lines":{"from":462,"to":465}}}}],["45",{"pageContent":"<div className=\"LidoFooterContainer\">\n          {state.sender && (\n            <div className=\"LidoFooterRaw\">\n              <div className=\"LidoFooterRawLeft\">You will receive</div>\n              <div className=\"LidoFooterRawRight\">${state.strEther ?? 0} stETH</div>\n            </div>\n          )}\n          <div className=\"LidoFooterRaw\">\n            <div className=\"LidoFooterRawLeft\">Exchange rate</div>\n            <div className=\"LidoFooterRawRight\">1 ETH = 1 stETH</div>","metadata":{"loc":{"lines":{"from":467,"to":476}}}}],["46",{"pageContent":"</div>\n          {false && (\n            <div className=\"LidoFooterRaw\">\n              <div className=\"LidoFooterRawLeft\">Transaction cost</div>\n              <div className=\"LidoFooterRawRight\">{state.txCost}</div>\n            </div>\n          )}\n          <div className=\"LidoFooterRaw\">\n            <div className=\"LidoFooterRawLeft\">Reward fee</div>\n            <div className=\"LidoFooterRawRight\">10%</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </Theme>\n);","metadata":{"loc":{"lines":{"from":477,"to":492}}}}],["47",{"pageContent":"```\n\n</WidgetEditor>\n\n:::danger ETH Disabled in Docs\nFor security reasons, interacting with Ethereum is disabled in our documentation. To see a working example please navigate to the [deployed NEAR Component](https://near.social/zavodil.near/widget/Lido).\n:::\n\n---","metadata":{"loc":{"lines":{"from":493,"to":501}}}}],["48",{"pageContent":"## Next Steps\nBuild and deploy your first components without leaving the browser. Go to https://near.org/sandbox , create an account and start building!","metadata":{"loc":{"lines":{"from":504,"to":505}}}}],["49",{"pageContent":"---\nid: interaction\ntitle: Smart Contract Interaction\n---\n\nYour frontend can interact with different blockchains using the built-in BOS API. Let's see how to create an application that reads and stores a greeting from a NEAR smart contract. \n\n![widgets](/docs/hello-near-logedin.png)\n*View of our Hello Near app when the user is logged-in*\n\n:::info\nCheck the finished example at [near.social code page](https://near.social/#/mob.near/widget/WidgetSource?src=gagdiez.near/widget/HelloNear).\n:::\n\n---","metadata":{"loc":{"lines":{"from":1,"to":15}}}}],["50",{"pageContent":"## The Contract\n\nWe have deployed a `Hello World` smart contract in the NEAR network at `hello.near-examples.near`. The contract exposes two methods:\n- `set_greeting(greeting: string): void`, which accepts a greeting and stores it in the contract state.\n- `get_greeting(): string` which returns the stored greeting.\n\n---","metadata":{"loc":{"lines":{"from":17,"to":23}}}}],["51",{"pageContent":"## Retrieving the Greeting\nSince we want to interact with the NEAR network, we will use the `Near` object from the BOS API.\n\n```ts\nconst contract = \"hello.near-examples.near\";\nconst greeting = Near.view(contract, \"get_greeting\", {});\n\nreturn <div>{greeting} World</div>;\n```\n\nAssuming the contract is storing `\"Hello\"`, this will render a simple:\n\n```json\nHello World\n```\n\n---","metadata":{"loc":{"lines":{"from":25,"to":41}}}}],["52",{"pageContent":"## Changing the Greeting\nTo modify the greeting, we simply need to use `Near.call` to call the `set_greeting` method. This however, requires us to have a frontend in which the user can input the new greeting.\n\nLets create it in two steps:\n1. Build the HTML that will be rendered\n2. Add the logic to handle the function call\n\n<hr className=\"subsection\" />","metadata":{"loc":{"lines":{"from":43,"to":50}}}}],["53",{"pageContent":"### 1. HTML Components\nUse the following code to create a simple frontend, composed by a title, an input form to change the greeting, and a button to submit the change.\n\n```js\nconst contract = \"hello.near-examples.near\";\nconst greeting = Near.view(contract, \"get_greeting\", {});","metadata":{"loc":{"lines":{"from":52,"to":57}}}}],["54",{"pageContent":"// Define components\nconst greetingForm = (\n  <>\n    <div className=\"border border-black p-3\">\n      <label>Update greeting</label>\n      <input placeholder=\"Howdy\" onChange={onInputChange} />\n      <button className=\"btn btn-primary mt-2\" onClick={onBtnClick}>\n        Save\n      </button>\n    </div>\n  </>\n);\n\nconst notLoggedInWarning = <p> Login to change the greeting </p>;","metadata":{"loc":{"lines":{"from":59,"to":72}}}}],["55",{"pageContent":"// Render\nreturn (\n  <>\n    <div className=\"container border border-info p-3\">\n      <h3 className=\"text-center\">\n        The contract says:\n        <span className=\"text-decoration-underline\"> {greeting} </span>\n      </h3>\n\n      <p className=\"text-center py-2\">\n        Look at that! A greeting stored on the NEAR blockchain.\n      </p>\n\n      {context.accountId ? greetingForm : notLoggedInWarning}\n    </div>\n  </>\n);","metadata":{"loc":{"lines":{"from":74,"to":90}}}}],["56",{"pageContent":"```\n\n:::info Relevant HTML\nThere are two important things to notice in the code above:\n\n1. **onChange & onClick**: We have prepared our `<input>` and `<button>` to act when something happens. Particularly, we will build two methods: one when the input changes, and one when the button is pressed.\n\n2. **context.accountId**: We check if `context.accountId` is set, which tells us if the user has logged in using their NEAR account, and thus can interact with NEAR contracts.\n:::","metadata":{"loc":{"lines":{"from":91,"to":99}}}}],["57",{"pageContent":"<hr className=\"subsection\" />","metadata":{"loc":{"lines":{"from":101,"to":101}}}}],["58",{"pageContent":"### 2. Handling User's Input\nHaving our component's view ready, we now need to define the logic for when the user inputs a new greeting and presses the `Submit` button. This is, we need to define the `onInputChange` and `onBtnClick` methods.","metadata":{"loc":{"lines":{"from":103,"to":104}}}}],["59",{"pageContent":"#### onInputChange\nWhen the user inputs a new greeting, we want to store it somewhere until the `Submit` button is pressed, for this, we can use the [application's State](../api/state.md).\n\nIn BOS, the state is initialized through `State.init`, updated with `State.update`, and accessed through the `state` variable (notice the lowercase). Lets store the new greeting in the App's state:\n\n```js\nState.init({ new_greeting: \"\" });","metadata":{"loc":{"lines":{"from":106,"to":112}}}}],["60",{"pageContent":"const onInputChange = ({ target }) => {\n  State.update({ new_greeting: target.value });\n};\n```","metadata":{"loc":{"lines":{"from":114,"to":117}}}}],["61",{"pageContent":"#### onBtnClick\nThe only thing left to do, is to handle when the user clicks the `Submit` button. What we want is to check if the user changed the greeting, and submit it to the contract.\n\n```js\nconst onBtnClick = () => {\n  if (!state.new_greeting) {\n    return;\n  }\n\n  Near.call(contract, \"set_greeting\", {\n    greeting: state.new_greeting,\n  });\n};\n```\n\n---","metadata":{"loc":{"lines":{"from":119,"to":134}}}}],["62",{"pageContent":"## Complete Example\nWe have deployed a complete version of this example on the NEAR blockchain, so you can see its code and play with it.\n\n:::tip\n- **Code**: Check the code of this example at the [near.social code page](https://near.social/#/mob.near/widget/WidgetSource?src=gagdiez.near/widget/HelloNear).\n\n- **Try It**: Interact with the application at the [near.social page](https://near.social/#/gagdiez.near/widget/HelloNear).\n:::","metadata":{"loc":{"lines":{"from":136,"to":143}}}}],["63",{"pageContent":"---\nid: lido\ntitle: Lido Example\n---\n\n# Hello Lido!\n\nIf you are ready to explore further, the [Lido component](https://near.org/zavodil.near/widget/Lido) serves as an excellent fully-fledged example, as it demonstrates how to interact with a smart contract deployed on the Ethereum mainnet.\n\n:::info Ethers.js","metadata":{"loc":{"lines":{"from":1,"to":10}}}}],["64",{"pageContent":"This component uses the [Ethers JavaScript](https://ethers.org) library to interact with Ethereum smart contracts. Follow [this link](https://docs.ethers.org/v6/) for the official `ethers.js` documentation.\n\n:::\n\n:::info Web3 connect","metadata":{"loc":{"lines":{"from":12,"to":16}}}}],["65",{"pageContent":"The Lido example uses the [Web3Connect component](https://near.org/near/widget/ComponentDetailsPage?src=a_liutiev.near/widget/button_web3connect) to provide a [WalletConnect modal](https://github.com/WalletConnect/web3modal) so the user can connect with any Web3 Ethereum wallet like Ledger or MetaMask.\n\n:::","metadata":{"loc":{"lines":{"from":18,"to":20}}}}],["66",{"pageContent":"### Fork the component\n\n1. Navigate to [the component](https://near.org/near/widget/ComponentDetailsPage?src=zavodil.near/widget/Lido)\n2. Select `Fork`\n3. Feel free to make any changes\n4. Click on <kbd>Save</kbd> to deploy the component\n\n:::note\nTo deploy the component, you'll need to sign in with a NEAR account and to make a deposit of a small amount of NEAR for the storage cost. This is because the components are stored in the NEAR network.\n:::","metadata":{"loc":{"lines":{"from":23,"to":32}}}}],["67",{"pageContent":"### Source code\n\n```js\nif (\n  state.chainId === undefined &&\n  ethers !== undefined &&\n  Ethers.send(\"eth_requestAccounts\", [])[0]\n) {\n  Ethers.provider()\n    .getNetwork()\n    .then((chainIdData) => {\n      if (chainIdData?.chainId) {\n        State.update({ chainId: chainIdData.chainId });\n      }\n    });\n}\nif (state.chainId !== undefined && state.chainId !== 1) {\n  return <p>Switch to Ethereum Mainnet</p>;\n}\n\n// FETCH LIDO ABI","metadata":{"loc":{"lines":{"from":34,"to":54}}}}],["68",{"pageContent":"const lidoContract = \"0xae7ab96520de3a18e5e111b5eaab095312d7fe84\";\nconst tokenDecimals = 18;\n\nconst lidoAbi = fetch(\n  \"https://raw.githubusercontent.com/lidofinance/lido-subgraph/master/abis/Lido.json\"\n);\nif (!lidoAbi.ok) {\n  return \"Loading\";\n}\n\nconst iface = new ethers.utils.Interface(lidoAbi.body);\n\n// FETCH LIDO STAKING APR","metadata":{"loc":{"lines":{"from":56,"to":68}}}}],["69",{"pageContent":"if (state.lidoArp === undefined) {\n  const apr = fetch(\n    \"https://api.allorigins.win/get?url=https://stake.lido.fi/api/sma-steth-apr\"\n  );\n  if (!apr) return;\n  State.update({ lidoArp: JSON.parse(apr?.body?.contents) ?? \"...\" });\n}\n\n// HELPER FUNCTIONS\n\nconst getStakedBalance = (receiver) => {\n  const encodedData = iface.encodeFunctionData(\"balanceOf\", [receiver]);","metadata":{"loc":{"lines":{"from":70,"to":81}}}}],["70",{"pageContent":"return Ethers.provider()\n    .call({\n      to: lidoContract,\n      data: encodedData,\n    })\n    .then((rawBalance) => {\n      const receiverBalanceHex = iface.decodeFunctionResult(\n        \"balanceOf\",\n        rawBalance\n      );\n\n      return Big(receiverBalanceHex.toString())\n        .div(Big(10).pow(tokenDecimals))\n        .toFixed(2)\n        .replace(/\\d(?=(\\d{3})+\\.)/g, \"$&,\");\n    });\n};","metadata":{"loc":{"lines":{"from":83,"to":99}}}}],["71",{"pageContent":"const submitEthers = (strEther, _referral) => {\n  if (!strEther) {\n    return console.log(\"Amount is missing\");\n  }\n  const erc20 = new ethers.Contract(\n    lidoContract,\n    lidoAbi.body,\n    Ethers.provider().getSigner()\n  );\n\n  let amount = ethers.utils.parseUnits(strEther, tokenDecimals).toHexString();\n\n  erc20.submit(lidoContract, { value: amount }).then((transactionHash) => {\n    console.log(\"transactionHash is \" + transactionHash);\n  });\n};\n\n// DETECT SENDER","metadata":{"loc":{"lines":{"from":101,"to":118}}}}],["72",{"pageContent":"if (state.sender === undefined) {\n  const accounts = Ethers.send(\"eth_requestAccounts\", []);\n  if (accounts.length) {\n    State.update({ sender: accounts[0] });\n    console.log(\"set sender\", accounts[0]);\n  }\n}\n\n//if (!state.sender)  return \"Please login first\";\n\n// FETCH SENDER BALANCE","metadata":{"loc":{"lines":{"from":120,"to":130}}}}],["73",{"pageContent":"if (state.balance === undefined && state.sender) {\n  Ethers.provider()\n    .getBalance(state.sender)\n    .then((balance) => {\n      State.update({ balance: Big(balance).div(Big(10).pow(18)).toFixed(2) });\n    });\n}\n\n// FETCH SENDER STETH BALANCE\n\nif (state.stakedBalance === undefined && state.sender) {\n  getStakedBalance(state.sender).then((stakedBalance) => {\n    State.update({ stakedBalance });\n  });\n}\n\n// FETCH TX COST","metadata":{"loc":{"lines":{"from":132,"to":148}}}}],["74",{"pageContent":"if (state.txCost === undefined) {\n  const gasEstimate = ethers.BigNumber.from(1875000);\n  const gasPrice = ethers.BigNumber.from(1500000000);\n\n  const gasCostInWei = gasEstimate.mul(gasPrice);\n  const gasCostInEth = ethers.utils.formatEther(gasCostInWei);","metadata":{"loc":{"lines":{"from":150,"to":155}}}}],["75",{"pageContent":"let responseGql = fetch(\n    \"https://api.thegraph.com/subgraphs/name/uniswap/uniswap-v2\",\n    {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({\n        query: `{\n          bundle(id: \"1\" ) {\n            ethPrice\n          }\n        }`,\n      }),\n    }\n  );\n\n  if (!responseGql) return \"\";\n\n  const ethPriceInUsd = responseGql.body.data.bundle.ethPrice;\n\n  const txCost = Number(gasCostInEth) * Number(ethPriceInUsd);","metadata":{"loc":{"lines":{"from":157,"to":176}}}}],["76",{"pageContent":"State.update({ txCost: `$${txCost.toFixed(2)}` });\n}\n\n// FETCH CSS\n\nconst cssFont = fetch(\n  \"https://fonts.googleapis.com/css2?family=Manrope:wght@200;300;400;500;600;700;800\"\n).body;\nconst css = fetch(\n  \"https://pluminite.mypinata.cloud/ipfs/Qmboz8aoSvVXLeP5pZbRtNKtDD3kX5D9DEnfMn2ZGSJWtP\"\n).body;\n\nif (!cssFont || !css) return \"\";","metadata":{"loc":{"lines":{"from":178,"to":190}}}}],["77",{"pageContent":"if (!state.theme) {\n  State.update({\n    theme: styled.div`\n    font-family: Manrope, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;\n    ${cssFont}\n    ${css}\n`,\n  });\n}\nconst Theme = state.theme;\n\n// OUTPUT UI\n\nconst getSender = () => {\n  return !state.sender\n    ? \"\"\n    : state.sender.substring(0, 6) +\n        \"...\" +\n        state.sender.substring(state.sender.length - 4, state.sender.length);\n};","metadata":{"loc":{"lines":{"from":192,"to":211}}}}],["78",{"pageContent":"return (\n  <Theme>\n    <div className=\"LidoContainer\">\n      <div className=\"Header\">Stake Ether</div>\n      <div className=\"SubHeader\">Stake ETH and receive stETH while staking.</div>","metadata":{"loc":{"lines":{"from":213,"to":217}}}}],["79",{"pageContent":"<div className=\"LidoForm\">\n        {state.sender && (\n          <>\n            <div className=\"LidoFormTopContainer\">\n              <div className=\"LidoFormTopContainerLeft\">\n                <div className=\"LidoFormTopContainerLeftContent1\">\n                  <div className=\"LidoFormTopContainerLeftContent1Container\">\n                    <span>Available to stake</span>\n                    <div className=\"LidoFormTopContainerLeftContent1Circle\" />\n                  </div>","metadata":{"loc":{"lines":{"from":219,"to":228}}}}],["80",{"pageContent":"</div>\n                <div className=\"LidoFormTopContainerLeftContent2\">\n                  <span>\n                    {state.balance ?? (!state.sender ? \"0\" : \"...\")}&nbsp;ETH\n                  </span>\n                </div>\n              </div>\n              <div className=\"LidoFormTopContainerRight\">\n                <div className=\"LidoFormTopContainerRightContent1\">\n                  <div className=\"LidoFormTopContainerRightContent1Text\">","metadata":{"loc":{"lines":{"from":229,"to":238}}}}],["81",{"pageContent":"<span>{getSender()}</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div className=\"LidoSplitter\" />\n          </>\n        )}\n        <div\n          className={\n            state.sender ? \"LidoFormBottomContainer\" : \"LidoFormTopContainer\"\n          }\n        >\n          <div className=\"LidoFormTopContainerLeft\">\n            <div className=\"LidoFormTopContainerLeftContent1\">","metadata":{"loc":{"lines":{"from":239,"to":253}}}}],["82",{"pageContent":"<div className=\"LidoFormTopContainerLeftContent1Container\">\n                <span>Staked amount</span>\n              </div>\n            </div>\n            <div className=\"LidoFormTopContainerLeftContent2\">\n              <span>\n                {state.stakedBalance ?? (!state.sender ? \"0\" : \"...\")}\n                &nbsp;stETH\n              </span>\n            </div>\n          </div>\n          <div className=\"LidoFormTopContainerRight\">\n            <div className=\"LidoAprContainer\">","metadata":{"loc":{"lines":{"from":254,"to":266}}}}],["83",{"pageContent":"<div className=\"LidoAprTitle\">Lido APR</div>\n              <div className=\"LidoAprValue\">{state.lidoArp ?? \"...\"}%</div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div className=\"LidoStakeForm\">\n        <div className=\"LidoStakeFormInputContainer\">\n          <span className=\"LidoStakeFormInputContainerSpan1\">\n            <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n              <path\n                opacity=\"0.6\"","metadata":{"loc":{"lines":{"from":267,"to":278}}}}],["84",{"pageContent":"d=\"M11.999 3.75v6.098l5.248 2.303-5.248-8.401z\"\n              ></path>\n              <path d=\"M11.999 3.75L6.75 12.151l5.249-2.303V3.75z\"></path>\n              <path\n                opacity=\"0.6\"\n                d=\"M11.999 16.103v4.143l5.251-7.135L12 16.103z\"\n              ></path>\n              <path d=\"M11.999 20.246v-4.144L6.75 13.111l5.249 7.135z\"></path>\n              <path\n                opacity=\"0.2\"\n                d=\"M11.999 15.144l5.248-2.993-5.248-2.301v5.294z\"","metadata":{"loc":{"lines":{"from":279,"to":289}}}}],["85",{"pageContent":"></path>\n              <path\n                opacity=\"0.6\"\n                d=\"M6.75 12.151l5.249 2.993V9.85l-5.249 2.3z\"\n              ></path>\n            </svg>\n          </span>\n          <span className=\"LidoStakeFormInputContainerSpan2\">\n            <input\n              disabled={!state.sender}\n              className=\"LidoStakeFormInputContainerSpan2Input\"\n              value={state.strEther}\n              onChange={(e) => State.update({ strEther: e.target.value })}","metadata":{"loc":{"lines":{"from":290,"to":302}}}}],["86",{"pageContent":"placeholder=\"Amount\"\n            />\n          </span>\n          <span\n            className=\"LidoStakeFormInputContainerSpan3\"\n            onClick={() => {\n              State.update({\n                strEther: (state.balance > 0.05\n                  ? parseFloat(state.balance) - 0.05\n                  : 0\n                ).toFixed(2),\n              });\n            }}\n          >\n            <button\n              className=\"LidoStakeFormInputContainerSpan3Content\"","metadata":{"loc":{"lines":{"from":303,"to":318}}}}],["87",{"pageContent":"disabled={!state.sender}\n            >\n              <span className=\"LidoStakeFormInputContainerSpan3Max\">MAX</span>\n            </button>\n          </span>\n        </div>\n        {!!state.sender ? (\n          <button\n            className=\"LidoStakeFormSubmitContainer\"\n            onClick={() => submitEthers(state.strEther, state.sender)}\n          >\n            <span>Submit</span>\n          </button>\n        ) : (\n          <Web3Connect","metadata":{"loc":{"lines":{"from":319,"to":333}}}}],["88",{"pageContent":"className=\"LidoStakeFormSubmitContainer\"\n            connectLabel=\"Connect with Web3\"\n          />\n        )}","metadata":{"loc":{"lines":{"from":334,"to":337}}}}],["89",{"pageContent":"<div className=\"LidoFooterContainer\">\n          {state.sender && (\n            <div className=\"LidoFooterRaw\">\n              <div className=\"LidoFooterRawLeft\">You will receive</div>\n              <div className=\"LidoFooterRawRight\">${state.strEther ?? 0} stETH</div>\n            </div>\n          )}\n          <div className=\"LidoFooterRaw\">\n            <div className=\"LidoFooterRawLeft\">Exchange rate</div>\n            <div className=\"LidoFooterRawRight\">1 ETH = 1 stETH</div>","metadata":{"loc":{"lines":{"from":339,"to":348}}}}],["90",{"pageContent":"</div>\n          {false && (\n            <div className=\"LidoFooterRaw\">\n              <div className=\"LidoFooterRawLeft\">Transaction cost</div>\n              <div className=\"LidoFooterRawRight\">{state.txCost}</div>\n            </div>\n          )}\n          <div className=\"LidoFooterRaw\">\n            <div className=\"LidoFooterRawLeft\">Reward fee</div>\n            <div className=\"LidoFooterRawRight\">10%</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </Theme>\n);\n```","metadata":{"loc":{"lines":{"from":349,"to":365}}}}],["91",{"pageContent":"#### Fork the component\n\n1. Navigate to [the component](https://near.org/near/widget/ComponentDetailsPage?src=zavodil.near/widget/Lido)\n2. Select `Fork`\n3. Feel free to make any changes\n4. Click on <kbd>Save</kbd> to deploy the component\n\n:::note\nTo deploy the component, you'll need to sign in with a NEAR account and to make a deposit of a small amount of NEAR for the storage cost. This is because NEAR components are stored in the NEAR network.\n:::","metadata":{"loc":{"lines":{"from":367,"to":376}}}}],["92",{"pageContent":"---\nid: ds-components\ntitle: Design Components\n---\n\n# Design System Components\n\nWhen building components, the NEAR VM provides a complete set of [Radix primitives](https://www.radix-ui.com/docs/primitives/overview/introduction) to simplify UI development.","metadata":{"loc":{"lines":{"from":1,"to":8}}}}],["93",{"pageContent":"## Radix UI\n\nUsing embedded Radix primitives on the NEAR VM is simple and straight-forward. You don't need to import any files:\n\n```js\nreturn (\n    <Label.Root className=\"LabelRoot\">\n      Hello World!\n    </Label.Root>\n);\n```\n\n:::caution Limitations\n\nCurrently, NEAR VM impose some limitations on the Radix UI framework:\n\n- `Form` component is not available.\n- You can't use `.Portal` definitions.\n- Using CSS is different. You'll have to use a `styled.div` wrapper.\n\n:::","metadata":{"loc":{"lines":{"from":10,"to":30}}}}],["94",{"pageContent":"### Using CSS\n\nHere is an example on how to use CSS through the `styled.div` wrapper:\n\n```js\nconst Wrapper = styled.div`\n  .SwitchRoot {\n    ...\n  }\n  .SwitchThumb {\n    ...\n  }\n`;\n\nreturn (\n  <Wrapper>\n    <Switch.Root className=\"SwitchRoot\">\n      <Switch.Thumb className=\"SwitchThumb\" />\n    </Switch.Root>\n  </Wrapper>\n);\n```\n\n:::tip Using Wrapper\n\n[Example widget using Wrapper](https://near.org/#/near/widget/ComponentDetailsPage?src=near/widget/RadixTooltipTest)\n\n:::","metadata":{"loc":{"lines":{"from":32,"to":59}}}}],["95",{"pageContent":"### Using `styled-components`\n\nYou can use [`styled-components`](../api/builtin-components.md#styled-components) in combination with Radix UI primitives. Here's an example:\n\n```js\nconst SwitchRoot = styled(\"Switch.Root\")`\n  all: unset;\n  display: block;\n  width: 42px;\n  height: 25px;\n  background-color: var(--blackA9);\n  border-radius: 9999px;\n  position: relative;\n  box-shadow: 0 2px 10px var(--blackA7);\n\n  &[data-state=\"checked\"] {\n    background-color: black;\n  }\n`;","metadata":{"loc":{"lines":{"from":61,"to":79}}}}],["96",{"pageContent":"const SwitchThumb = styled(\"Switch.Thumb\")`\n  all: unset;\n  display: block;\n  width: 21px;\n  height: 21px;\n  background-color: white;\n  border-radius: 9999px;\n  box-shadow: 0 2px 2px var(--blackA7);\n  transition: transform 100ms;\n  transform: translateX(2px);\n  will-change: transform;\n\n  &[data-state=\"checked\"] {\n    transform: translateX(19px);\n  }\n`;\n\nreturn (\n  <SwitchRoot>\n    <SwitchThumb />\n  </SwitchRoot>\n);","metadata":{"loc":{"lines":{"from":81,"to":102}}}}],["97",{"pageContent":"```\n\n:::tip Using styled components\n\n[Example widget using styled components to style Radix UI](https://near.org/#/near/widget/ComponentDetailsPage?src=near/widget/RadixSwitchTest).\n\n:::","metadata":{"loc":{"lines":{"from":103,"to":109}}}}],["98",{"pageContent":"### Forward references\n\nThe NEAR VM re-implements [React's forwardRef](https://react.dev/reference/react/forwardRef#reference) as `ref=\"forwardedRef\"`.\n\nYou can use `ref=\"forwardedRef\"` to forward references through `<Widget />` to support Radix's `asChild` property:\n\n```js title='Dialog.jsx'\n<AlertDialog.Trigger asChild>\n  <Widget\n    src=\"near/widget/TestButton\"\n    props={{ label: \"Click Me\" }}\n  />\n</AlertDialog.Trigger>","metadata":{"loc":{"lines":{"from":111,"to":123}}}}],["99",{"pageContent":"```\n\n```js title='TestButton.jsx'\nconst Button = styled.button`\n  background: #f00;\n`;\n\nreturn (\n  <Button type=\"button\" ref=\"forwardedRef\">\n    {props.label}: Forwarded\n  </Button>\n);\n```","metadata":{"loc":{"lines":{"from":124,"to":136}}}}],["100",{"pageContent":"## DIG components\n\nThese are the Design Interface Guidelines (DIG) components available on the NEAR VM:\n\n- [DIG.Button](https://near.org/#/near/widget/ComponentDetailsPage?src=near/widget/DIG.Button)\n- [DIG.Theme](https://near.org/#/near/widget/ComponentDetailsPage?src=near/widget/DIG.Theme)","metadata":{"loc":{"lines":{"from":138,"to":143}}}}],["101",{"pageContent":"### `DIG.Button`\n\nA fully featured button component that can act as a `<button>` or `<a>` tag.\n\n:::info DIG.Button properties\n[Click here](https://near.org/#/near/widget/ComponentDetailsPage?src=near/widget/DIG.Button&tab=about) for properties and details.\n\n:::","metadata":{"loc":{"lines":{"from":145,"to":152}}}}],["102",{"pageContent":"### `DIG.Theme`\n\nThis component wraps all of NEAR Components so you don't need to render it yourself.\n\n:::tip\nYou can use any of the [CSS variables](https://near.org/near/widget/ComponentDetailsPage?src=near/widget/DIG.Theme&tab=source) defined inside `DIG.Theme`.\n:::","metadata":{"loc":{"lines":{"from":154,"to":160}}}}],["103",{"pageContent":"---\nid: ethers-js\ntitle: NEAR for Ethereum developers\n---\n\nimport {WidgetEditor} from \"@site/src/components/widget-editor\"\n\nNEAR components are chain-agnostic, enabling you to create decentralized frontends tailored for any Ethereum dApps. Throughout this article, we'll navigate prevalent use-cases with code snippets. You’ll also find links to exemplary NEAR components for reference.\n\n---","metadata":{"loc":{"lines":{"from":1,"to":10}}}}],["104",{"pageContent":"## Interact with Ethereum using Ethers.js\n\nThe NEAR VM has imported the [Ethers.js](https://docs.ethers.org/) library, allowing for seamless interaction with Ethereum nodes using JavaScript in a NEAR component.","metadata":{"loc":{"lines":{"from":12,"to":14}}}}],["105",{"pageContent":"The `Ethers` object exposes the provider connection:\n- `Ethers.provider()` is a read-only connection to the blockchain, which allows querying the blockchain state (e.g., account, block or transaction details), querying event logs or evaluating read-only code using call.\n  - `Ethers.provider().getSigner()` abstracts the class that interacts with an account\n    - `Ethers.provider().getSigner().getBalance()` returns a Promise that resolves to the account address.","metadata":{"loc":{"lines":{"from":16,"to":19}}}}],["106",{"pageContent":"- `Ethers.provider().getBlockNumber()` looks up the current block number (i.e. height)\n  - `Ethers.provider().getFeeData()` gets the best guess at the recommended FeeData","metadata":{"loc":{"lines":{"from":20,"to":21}}}}],["107",{"pageContent":"You can see various ways of using `Ethers` objects on the [Ethers documentation portal](https://docs.ethers.org/)).","metadata":{"loc":{"lines":{"from":23,"to":23}}}}],["108",{"pageContent":"---\n    \nFurthermore, numerous [basic tools](https://docs.ethers.org/v6/api/utils/)  can be found in the ethers.utils object (be aware of the lowercase 'e').\n- `ethers.utils.parseUnits(value, unit)` converts the decimal string value to a BigInt, assuming unit decimal places. The unit may the number of decimal places or the name of a unit (e.g. \"gwei\" for 9 decimal places).\n- `ethers.utils.formatEther(wei)` converts value into a decimal string using 18 decimal places.","metadata":{"loc":{"lines":{"from":25,"to":29}}}}],["109",{"pageContent":"#### Example showing the difference between `Ethers.provider()` and `ethers.utils`:\n```ts\n    Ethers.provider()\n        .getSigner()\n        .getBalance()\n        .then((balance) => {\n            console.log(\"Your ETH balance: \", ethers.utils.formatEther(balance))\n        });\n```","metadata":{"loc":{"lines":{"from":31,"to":39}}}}],["110",{"pageContent":"## FAQ\n\n### How to get a user account?\n\n```ts\nconst receiver = Ethers.provider().send(\"eth_requestAccounts\", [])[0];\n```\n\n### How to get the current chain ID?\n\n```ts\nEthers.provider().getNetwork().then((chainIdData) => {\n    console.log(chainIdData.chainId);\n});\n```\n\n### How to show a Web3Login button?\n\n```ts\n<Web3ConnectButton \n    className=\"my-class\" \n    connectLabel=\"Connect Web3 Wallet\" \n    disconnectLabel=\"Disconnect Web3 Wallet\"\n    connectingLabel=\"Connecting...\" \n/>\n```","metadata":{"loc":{"lines":{"from":41,"to":66}}}}],["111",{"pageContent":"### How to load a contract ABI?\n\n```ts\nconst abi = fetch(`https://eth.blockscout.com/api?module=contract&action=getabi&address=0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2`);\n\nif (!abi.ok) {\n    return \"Loading\";\n}\n\nconsole.log(abi.body.result);\n```","metadata":{"loc":{"lines":{"from":68,"to":78}}}}],["112",{"pageContent":"### How to load data from EVM nodes?\n\n```ts\n// create a contract interface\nconst iface = new ethers.utils.Interface(abi.body.result);\n\n// encode the balanceOf get request\nconst encodedBalanceData = iface.encodeFunctionData(\"balanceOf\", [receiver]);","metadata":{"loc":{"lines":{"from":80,"to":87}}}}],["113",{"pageContent":"// perform a call\nEthers.provider().call({\n    to: \"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2\",\n    data: encodedBalanceData,\n})\n.then((rawBalance) => {\n    // decode the result\n    const receiverBalanceHex = iface.decodeFunctionResult(\n        \"balanceOf\",\n        rawBalance\n    );\n    console.log(Big(receiverBalanceHex).toFixed());\n});\n```","metadata":{"loc":{"lines":{"from":89,"to":102}}}}],["114",{"pageContent":"### How to send a transaction to Ethereum nodes?\n\n```ts\n// create a contract instance\nconst wEthContract = new ethers.Contract(\n    \"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2\",\n    abi.body.result,\n    Ethers.provider().getSigner()\n);\n\n// perform a given method (withdraw in this case)\nwEthContract\n    .withdraw(balance, {\n        value: 0\n    })\n    .then((transactionHash) => {\n        console.log(transactionHash);\n    });\n```","metadata":{"loc":{"lines":{"from":104,"to":122}}}}],["115",{"pageContent":"### How to convert HEX values to human readable numbers?\n\n```ts\n// use Big().toFixed method\n\nBig(balanceHex).toFixed()\n```\n\n### How to locate the ABI of a Smart Contract?\n\nUtilize platforms like etherscan.com and blockscout.com, or delve into the project's GitHub repositories and documentation.","metadata":{"loc":{"lines":{"from":124,"to":134}}}}],["116",{"pageContent":"### Is there an example of applications with a description of how they were created? \n\nYes, there is an article that describes [best practices for creating applications for Ethereum developers on NEAR](bos-ethersjs-best-practices.md), with a breakdown of individual steps.","metadata":{"loc":{"lines":{"from":136,"to":138}}}}],["117",{"pageContent":"## Examples\n\nBelow is a curated list of NEAR components, developed by the community, that epitomize the best practices for creating NEAR components:","metadata":{"loc":{"lines":{"from":140,"to":142}}}}],["118",{"pageContent":"- [Unwrap ETH](https://near.org/near/widget/ComponentDetailsPage?src=zavodil.near/widget/unwrap-weth&tab=source)\n- [ERC-20 Token sender](https://near.org/near/widget/ComponentDetailsPage?src=zavodil.near/widget/erc20-sender&tab=source)\n- [Lido Component](https://near.org/near/widget/ComponentDetailsPage?src=zavodil.near/widget/Lido&tab=source)","metadata":{"loc":{"lines":{"from":144,"to":146}}}}],["119",{"pageContent":"- [Swap component](https://near.org/near/widget/ComponentDetailsPage?src=zavodil.near/widget/swap&tab=source) (a set of swap dApps for Ethereum Mainnet, Polygon Mainnet, Polygon zkevm, Aurora, NEAR, etc)\n- [1inch](https://near.org#/near/widget/ComponentDetailsPage?src=chanon.near/widget/1inch)\n- [Liquity](https://near.org/near/widget/ComponentDetailsPage?src=garlicfaucet.near/widget/liquityWidget)","metadata":{"loc":{"lines":{"from":147,"to":149}}}}],["120",{"pageContent":"---\nid: ethers-js-best-practices\ntitle: Best Practices for Ethereum developers on NEAR\n---\n\nimport {WidgetEditor} from \"@site/src/components/widget-editor\"\n\nIn this example, we will create an Ethereum dApp on NEAR that functions as a portfolio manager, displaying the current balances for a list of tokens. Additionally, we will display current market value of each asset in the portfolio.","metadata":{"loc":{"lines":{"from":1,"to":8}}}}],["121",{"pageContent":"We will be using several technologies:\n- NEAR Components for the user interface (UI).\n- [Ethers.js](bos-ethersjs.md) for retrieving balance data from the blockchain.\n- CoinGecko API for fetching static content with information about tokens and their current prices.\n- [Social-DB](../../social/contract.md) for storing the list of tokens to be tracked.\n- GitHub Actions for caching static content, speeding up loading, and circumventing rate limits.","metadata":{"loc":{"lines":{"from":10,"to":15}}}}],["122",{"pageContent":"## Step 1: Load balances from chain\n\nLet's start with a simple example and consider an application where we want to display a user's balances for multiple tokens.","metadata":{"loc":{"lines":{"from":17,"to":19}}}}],["123",{"pageContent":"### Source code\n\n```js\n// Load current sender address if it was not loaded yet\nif (state.sender == undefined && Ethers.provider()) {\n  Ethers.provider()\n    .send(\"eth_requestAccounts\", [])\n    .then((accounts) => {\n      if (accounts.length) {\n        // save sender address to the state\n        State.update({ sender: accounts[0] });\n      }\n    });\n}","metadata":{"loc":{"lines":{"from":21,"to":34}}}}],["124",{"pageContent":"// Load ERC20 ABI JSON\nconst erc20Abi = fetch(\n  \"https://ipfs.near.social/ipfs/bafkreifgw34kutqcnusv4yyv7gjscshc5jhrzw7up7pdabsuoxfhlnckrq\"\n);\nif (!erc20Abi.ok) {\n  return \"Loading\";\n}\n\n// Create contract interface\nconst iface = new ethers.utils.Interface(erc20Abi.body);\n\n// specify list of tokens\nconst tokens = [\n  \"0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599\", // WBTC\n  \"0x6b175474e89094c44da98b954eedeac495271d0f\", // DAI\n  \"0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984\", // UNI\n];","metadata":{"loc":{"lines":{"from":36,"to":52}}}}],["125",{"pageContent":"// load receiver's balance for a giver token\nconst getTokenBalance = (receiver, tokenId) => {\n  // encode `balanceOf` request\n  const encodedData = iface.encodeFunctionData(\"balanceOf\", [receiver]);\n\n  // send request to the network\n  return Ethers.provider()\n    .call({\n      to: tokenId,\n      data: encodedData,\n    })\n    .then((rawBalance) => {\n      // decode response\n      const receiverBalanceHex = iface.decodeFunctionResult(\n        \"balanceOf\",\n        rawBalance\n      );","metadata":{"loc":{"lines":{"from":54,"to":70}}}}],["126",{"pageContent":"return Big(receiverBalanceHex).toFixed(0);\n    });\n};\n\nconst loadTokensData = () => {\n  // load balances of all tokens\n  tokens.map((tokenId) => {\n    getTokenBalance(state.sender, tokenId).then((value) => {\n      // save balance of every token to the state\n      State.update({ [tokenId]: { balance: value, ...state[tokenId] } });\n    });\n  });\n};\n\nconst renderToken = (tokenId) => (\n  <li>\n    {tokenId}: {state[tokenId].balance}\n  </li>\n);\n\nif (state.sender) {\n  loadTokensData();","metadata":{"loc":{"lines":{"from":72,"to":93}}}}],["127",{"pageContent":"return (\n    <>\n      <ul>{tokens.map((tokenId) => renderToken(tokenId))}</ul>\n      <p>Your account: {state.sender} </p>\n    </>\n  );\n} else {\n  // output connect button for anon user\n  return <Web3Connect />;\n}","metadata":{"loc":{"lines":{"from":95,"to":104}}}}],["128",{"pageContent":"```\n\nYou can see how it works here: [step_1](https://near.org/near/widget/ComponentDetailsPage?src=zavodil.near/widget/token-balances-step-1&tab=source).\n\nOnce the web3 connection is enabled, the output will appear as follows:\n\n```\n0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599: 726220\n0x6b175474e89094c44da98b954eedeac495271d0f: 140325040242585301886\n0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984: 127732731780832810","metadata":{"loc":{"lines":{"from":105,"to":114}}}}],["129",{"pageContent":"```\n\n:::tip\nWhen developing NEAR components, it's recommended to always present some content even if the user hasn't connected their wallet yet. In this example, the component uses the `<Web3Connect>` button to prompt the user to connect their wallet if they haven't already.\n:::","metadata":{"loc":{"lines":{"from":115,"to":119}}}}],["130",{"pageContent":"## Step 2: Load static data\n\n\nTo format the list, we must determine the decimal precision for each asset. While it's possible to retrieve this information from the ERC-20 contract for each token, it's important to note that the ERC-20 contract lacks certain valuable data such as the token icon and description. As a solution, we can leverage the CoinGecko API to retrieve token details, including the current market price.","metadata":{"loc":{"lines":{"from":121,"to":124}}}}],["131",{"pageContent":"Let's add a function to load token data for a given token from the Coingecko:\n\n```js\nconst loadCoingeckData = (tokenId) => {\n    let dataUrl = `https://api.coingecko.com/api/v3/coins/ethereum/contract/${tokenId}`;","metadata":{"loc":{"lines":{"from":126,"to":130}}}}],["132",{"pageContent":"const data = fetch(dataUrl);\n    if (data.ok) {\n        return {\n            name: data.body.name,\n            icon: data.body.image.small,\n            decimals: data.body.detail_platforms[\"ethereum\"].decimal_place,\n            price: Number(data.body.market_data.current_price.usd),\n        };\n    }\n};","metadata":{"loc":{"lines":{"from":132,"to":141}}}}],["133",{"pageContent":"```\n\nOther available API methods are listed in the [Coingecko API documentation](https://www.coingecko.com/en/api).\n\nNow that we have the data, let's modify the loadTokensData function to save the token information in the state:","metadata":{"loc":{"lines":{"from":142,"to":146}}}}],["134",{"pageContent":"```js\nconst loadTokensData = () => {\n  // load balances of all tokens\n  tokens.map((tokenId) => {\n    getTokenBalance(state.sender, tokenId).then((value) => {\n      // save balance of every token to the state\n      State.update({ [tokenId]: { balance: value, ...state[tokenId] } });\n    });\n  });","metadata":{"loc":{"lines":{"from":148,"to":156}}}}],["135",{"pageContent":"tokens.map((tokenId) => {\n    const tokenData = loadCoingeckData(tokenId);\n    // save balance of every token to the state\n    State.update({ [tokenId]: { ...tokenData, ...state[tokenId] } });\n  });\n};","metadata":{"loc":{"lines":{"from":158,"to":163}}}}],["136",{"pageContent":"```\n\nAnd lets update the `renderToken` function to display data we just got:","metadata":{"loc":{"lines":{"from":164,"to":166}}}}],["137",{"pageContent":"```js \nconst renderToken = (tokenId) => {\n  const tokenBalance = Big(state[tokenId].balance ?? 0)\n    .div(new Big(10).pow(state[tokenId].decimals ?? 1))\n    .toFixed(4);\n  const tokenBalanceUSD = (tokenBalance * state[tokenId].price).toFixed(2);\n  return (\n    <li>\n      {state[tokenId].name}: {tokenBalance}{\" \"}\n      <img src={state[tokenId].icon} width=\"16\" alt={state[tokenId].symbol} />\n      {`(${tokenBalanceUSD} USD)`}\n    </li>\n  );\n};","metadata":{"loc":{"lines":{"from":168,"to":181}}}}],["138",{"pageContent":"```\n\nYou can see how it works here: [step_2](https://near.org/near/widget/ComponentDetailsPage?src=zavodil.near/widget/token-balances-step-2&tab=source).\n\nOutput will be like this:\n```\nWrapped Bitcoin: 0.0073 wbtc (247.64 USD)\nDai: 140.3250 dai (140.21 USD)\nUniswap: 0.1277 uni (0.54 USD)","metadata":{"loc":{"lines":{"from":182,"to":190}}}}],["139",{"pageContent":"```\n\n:::info\nPlease note that the `fetch` function caches data and will be executed only once during loading.\n:::\n\n:::tip\nUtilize any available web-services to provide data for your application on NEAR, ensuring that the user experience is on par with traditional web 2.0 applications.\n:::","metadata":{"loc":{"lines":{"from":191,"to":199}}}}],["140",{"pageContent":"## Step 3. Save data in social-db\n\nNow, instead of hardcoding the list of tokens directly within the application code, let's transition them to an onchain data repository named social-db. This approach allows us to adjust the list of trackable tokens without having to modify the application's code. It also offers users the flexibility to select from pre-existing token lists or formulate their own.","metadata":{"loc":{"lines":{"from":201,"to":203}}}}],["141",{"pageContent":"Learn more about how [key-value storage social-db works](https://github.com/NearSocial/social-db/blob/master/README.md).\n\nHere is an example of a simple application for [setting tokens list in social-db](https://near.org/near/widget/ComponentDetailsPage?src=zavodil.near/widget/tokens-db&tab=source). \n\nIn this format, the data from the example will be stored in social-db.","metadata":{"loc":{"lines":{"from":205,"to":209}}}}],["142",{"pageContent":"```\n{\n\"0x6b175474e89094c44da98b954eedeac495271d0f\": \"\",\n\"0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599\": \"\",\n\"0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984\": \"\"\n}","metadata":{"loc":{"lines":{"from":211,"to":216}}}}],["143",{"pageContent":"```\n\n\nViewing this data from the blockchain is accessible for every NEAR app or, for example, through an [Explorer app](https://near.org/zavodil.near/widget/Explorer?path=zavodil.near/tokens-db/**).\n\nLet's add a function to our application that will read the list of tokens.\n\n```js\n// set list of tokens\nif (!state.tokensLoaded) {\n    // load tokens list from the Social DB\n    const tokens = Social.get(`zavodil.near/tokens-db/*`, \"final\");","metadata":{"loc":{"lines":{"from":217,"to":228}}}}],["144",{"pageContent":"if (tokens) {\n        State.update({\n            tokensLoaded: true,\n            tokens,\n        });\n    }\n}\n\nconst tokens = Object.keys(state.tokens ?? {});\n```\n:::info\nIn this case, `zavodil.near` is the NEAR account of the user who created this list of tokens. Any other user can create their own list, and it will also be available in `social-db`.\n:::","metadata":{"loc":{"lines":{"from":230,"to":242}}}}],["145",{"pageContent":"You can see how it works here: [step_3](https://near.org/near/widget/ComponentDetailsPage?src=zavodil.near/widget/token-balances-step-3&tab=source). The output of the data in the application remains unchanged, but now it no longer contains hardcoded values.\n\n:::tip\nUse social-db, an on-chain data storage, to decouple the data and the application. \n:::","metadata":{"loc":{"lines":{"from":244,"to":248}}}}],["146",{"pageContent":"## Step 4. Caching Data Through GitHub Actions","metadata":{"loc":{"lines":{"from":250,"to":250}}}}],["147",{"pageContent":"Ethereum-based applications frequently depend on static content sources to present details about tokens or contracts. Often, frontends pull this data from platforms like CoinGecko or CoinMarketCap, leveraging API keys to enhance the data retrieval rate limit. Without these API keys, and given a significant volume of data, fetching from these platforms can be sluggish or even disrupted. We'll showcase a serverless approach utilizing GitHub Actions. This method preserves the decentralized nature","metadata":{"loc":{"lines":{"from":252,"to":252}}}}],["148",{"pageContent":"of NEAR gateways (where securely storing API keys isn't feasible), all while ensuring user ease-of-use and swift data loading.","metadata":{"loc":{"lines":{"from":252,"to":252}}}}],["149",{"pageContent":"Let's create a Node.js application that will iterate through a list of tokens from `social-db` and display the retrieved data along with a timestamp of the operation.\n\n```js\nimport * as nearAPI from \"near-api-js\";\nimport * as cg from \"coingecko-api-v3\";\n\nconst CONTRACT_ID = \"social.near\";\nconst ETHEREUM_NETWORK_ID = \"ethereum\";\nconst FETCH_TIMEOUT = 7000;","metadata":{"loc":{"lines":{"from":254,"to":262}}}}],["150",{"pageContent":"async function connect() {\n    const config = {\n        networkId: \"mainnet\",\n        keyStore: new nearAPI.keyStores.InMemoryKeyStore(),\n        nodeUrl: \"https://rpc.mainnet.near.org\",\n        walletUrl: \"https://wallet.mainnet.near.org\",\n        helperUrl: \"https://helper.mainnet.near.org\",\n        explorerUrl: \"https://nearblocks.io\",\n    };\n    const near = await nearAPI.connect(config);\n    const account = await near.account(CONTRACT_ID);","metadata":{"loc":{"lines":{"from":264,"to":274}}}}],["151",{"pageContent":"const contract = new nearAPI.Contract(\n        account, // the account object that is connecting\n        CONTRACT_ID, // name of contract you're connecting to\n        {\n            viewMethods: [\"get\"], // view methods do not change state but usually return a value\n            changeMethods: [], // change methods modify state\n            sender: account, // account object to initialize and sign transactions.\n        }\n    );\n\n    return contract;\n}","metadata":{"loc":{"lines":{"from":276,"to":287}}}}],["152",{"pageContent":"// load data from the social-db\nconst contract = await connect();\nconst data = await contract.get({ keys: [\"zavodil.near/tokens-db/*\"] });\nconst tokens = data[\"zavodil.near\"][\"tokens-db\"];\n\n// init coingecko client\nconst client = new cg.CoinGeckoClient({\n    timeout: 5000,\n    autoRetry: false,\n});\n\nlet res = {};\nfor (let i = 0; i < Object.keys(tokens).length; i++) {\n    const tokenId = Object.keys(tokens)[i];","metadata":{"loc":{"lines":{"from":289,"to":302}}}}],["153",{"pageContent":"try {\n        // load data from coingecko\n        const data = await client.contract({\n            id: ETHEREUM_NETWORK_ID,\n            contract_address: tokenId,\n        });\n        // format output\n        const tokenData = {\n            name: data[\"name\"],\n            symbol: data[\"symbol\"],\n            icon: data[\"image\"]?.[\"thumb\"],\n            decimals: data[\"detail_platforms\"]?.[ETHEREUM_NETWORK_ID]?.[\"decimal_place\"],","metadata":{"loc":{"lines":{"from":304,"to":315}}}}],["154",{"pageContent":"price: data[\"market_data\"]?.[\"current_price\"]?.[\"usd\"],\n        };\n        // store output\n        res[tokenId] = tokenData;","metadata":{"loc":{"lines":{"from":316,"to":319}}}}],["155",{"pageContent":"// add timeout to avoid rate limits\n        await new Promise((resolve) => {\n            setTimeout(resolve, FETCH_TIMEOUT);\n        });\n    } catch (ex) {\n        console.error(tokenId, ex)\n    }\n}\n\n// output results\nconsole.log(\n    JSON.stringify({\n        timestamp: Date.now(),\n        data: res,\n    })\n);","metadata":{"loc":{"lines":{"from":321,"to":336}}}}],["156",{"pageContent":"```\n\nExample [of this code on a github](https://github.com/zavodil/tokens-db/),  you can clone the repository and modify the data retrieval request as needed.\n\nNow, we can create a GitHub worker that will execute this script and save the data to a file named `tokens-db.json`. Here are the instructions for the worker:\n\n```yml\nname: Tokens Data Updater\non:\n  workflow_dispatch:\n  schedule:\n    - cron:  '*/15 * * * *'","metadata":{"loc":{"lines":{"from":338,"to":349}}}}],["157",{"pageContent":"jobs:\n  updateStats:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - name: Prepare        \n        uses: actions/setup-node@v3\n        with:\n            node-version: 16\n      - run: npm i      \n      - name: Tokens Data\n        run: node load > tokens-db.json              \n        env:\n          EXPORT_MODE: CS\n      - uses: EndBug/add-and-commit@v9 \n        with: \n          author_name: \"Tokens Data Updater\"\n          add: 'tokens-db.json --force'","metadata":{"loc":{"lines":{"from":351,"to":368}}}}],["158",{"pageContent":"message: \"Tokens Data fetching\"","metadata":{"loc":{"lines":{"from":369,"to":369}}}}],["159",{"pageContent":"```\n\nDon't forget to grant the worker the necessary permissions to add files to your repository (Open GitHub Repository: Settings->Actions->General)\n\nThe output of this worker will be the [tokens-db.json](https://raw.githubusercontent.com/zavodil/tokens-db/main/tokens-db.json) file which will be regularly updated with current data. You can easily add any private API keys required for bypassing rate limits in the worker.","metadata":{"loc":{"lines":{"from":370,"to":374}}}}],["160",{"pageContent":"Now, let's get back to the NEAR application. We need to modify the code to read data from the cached file created by GitHub Actions instead of fetching it from CoinGecko every time.\n\nTo do this, we'll make changes to the `loadTokensData` function:","metadata":{"loc":{"lines":{"from":376,"to":378}}}}],["161",{"pageContent":"```js\nconst loadTokensData = () => {\n    let cacheTokenData = {};\n    // load data generated by github action\n    const cachedData = fetch(\n        `https://raw.githubusercontent.com/zavodil/tokens-db/main/tokens-db.json`\n    );\n    if (cachedData.ok) {\n        const cache = JSON.parse(cachedData.body);\n        const cacheDate = new Date(cache.timestamp);\n        const timeDifference = Date.now() - cacheDate.getTime();","metadata":{"loc":{"lines":{"from":380,"to":390}}}}],["162",{"pageContent":"if (timeDifference <= 30 * 60 * 1000) {  // use cached data if it is not outdated (30 min)\n            cacheTokenData = cache.data;\n        }","metadata":{"loc":{"lines":{"from":391,"to":393}}}}],["163",{"pageContent":"tokens.map((tokenId) => {\n            const tokenData = cacheTokenData.hasOwnProperty(tokenId)\n                ? cacheTokenData?.[tokenId]\n                : // load data from coingecko if we don't have cached data only\n                loadCoingeckData(tokenId);\n            // save balance of every token to the state\n            State.update({ [tokenId]: { ...tokenData, ...state[tokenId] } });\n        });\n    }\n};","metadata":{"loc":{"lines":{"from":395,"to":404}}}}],["164",{"pageContent":"```\n\nYou can see how it works here: [step_4](https://near.org/near/widget/ComponentDetailsPage?src=zavodil.near/widget/token-balances-step-4&tab=source). The output of the data in the application remains the same, but now it operates more efficiently.\n\n:::tip\nUse GitHub Actions as a serverless backend for securing API keys, caching data etc. \n:::","metadata":{"loc":{"lines":{"from":406,"to":412}}}}],["165",{"pageContent":"---\nid: near\ntitle: Interacting with Near\n---\n\nimport Tabs from '@theme/Tabs';\nimport TabItem from '@theme/TabItem';\nimport {WidgetEditor} from \"@site/src/components/widget-editor\"\n\nThe components can use the `Near` object to interact with smart contracts in the NEAR blockchain. There are three methods:\n\n- [`Near.view`](#nearview)\n- [`Near.block`](#nearblock)\n- [`Near.call`](#nearcall)\n\n---","metadata":{"loc":{"lines":{"from":1,"to":16}}}}],["166",{"pageContent":"## Near.view\nQueries a read-only method from a NEAR smart contract, returning:\n- **`null`**: If the query is still being processed\n- **`undefined`**: If the query is complete and no value was returned by the contract\n- A **value**: If the query is complete and a value was returned by the contract\n\n<WidgetEditor>\n\n```js\nconst greeting = Near.view(\"hello.near-examples.testnet\", \"get_greeting\", {});\n\nif (greeting === null) return \"Loading...\";\n\nreturn `The contract says: ${greeting}`;","metadata":{"loc":{"lines":{"from":18,"to":31}}}}],["167",{"pageContent":"```\n\n</WidgetEditor>\n\n<details markdown=\"1\">\n<summary> Parameters </summary>","metadata":{"loc":{"lines":{"from":32,"to":37}}}}],["168",{"pageContent":"| param              | required     | type            | description                                                                                                                    |\n|--------------------|--------------|-----------------|--------------------------------------------------------------------------------------------------------------------------------|","metadata":{"loc":{"lines":{"from":39,"to":40}}}}],["169",{"pageContent":"| `contractName`     | **required** | string          | Name of the smart contract                                                                                                     |\n| `methodName`       | **required** | string          | Name of the method to call                                                                                                     |","metadata":{"loc":{"lines":{"from":41,"to":42}}}}],["170",{"pageContent":"| `args`             | _optional_   | object instance | Arguments to pass to the method                                                                                                |\n| `blockId/finality` | _optional_   | string          | Block ID or finality of the transaction                                                                                        |","metadata":{"loc":{"lines":{"from":43,"to":44}}}}],["171",{"pageContent":"| `subscribe`        | _optional_   | boolean         | This feature allows users to subscribe to a query, which automatically refreshes the data for all subscribers every 5 seconds. |","metadata":{"loc":{"lines":{"from":45,"to":45}}}}],["172",{"pageContent":"</details>\n\n:::tip\nNotice that the optional parameter `subscribe` allows users to subscribe to a query, which automatically refreshes the data every 5 seconds.\n:::\n\n<hr className=\"subsection\" />","metadata":{"loc":{"lines":{"from":47,"to":53}}}}],["173",{"pageContent":"#### Avoiding a Common Pitfall\n\nIf you want to initialize the state with the result of a `Near.view` call, be sure to check first that the value was obtained, to avoid initializing the state with `null`.\n\n<WidgetEditor>\n\n```js\nconst contractGreet = Near.view(\"hello.near-examples.testnet\", \"get_greeting\", {});\n\n// you need to first check that the value was obtained\nif (contractGreet === null) return \"Loading...\";\n\nconst [greeting, setGreeting] = useState(contractGreet);","metadata":{"loc":{"lines":{"from":55,"to":67}}}}],["174",{"pageContent":"return `The contract says: ${greeting}`;","metadata":{"loc":{"lines":{"from":69,"to":69}}}}],["175",{"pageContent":"```\n\n</WidgetEditor>\n\nIf you don't want to delay the render of your component, you can also use the `useEffect` hook to control the value returned by `Near.view`\n\n<WidgetEditor>\n\n```js\nconst contractGreet = Near.view('hello.near-examples.testnet', 'get_greeting');\n\nconst [greeting, setGreeting] = useState('Loading ...');\n\nuseEffect(() => {\n  if (contractGreet !== null) setGreeting(contractGreet);\n}, [contractGreet]);\n\nreturn `The contract says: ${greeting}`;\n```\n\n</WidgetEditor>\n\n---","metadata":{"loc":{"lines":{"from":70,"to":92}}}}],["176",{"pageContent":"## Near.call\n\nCalls a smart contract method from the blockchain. Since a transaction needs to be signed, the user must be logged in in order to make the call.\n\n<WidgetEditor>\n\n```js\nif (!context.accountId) return \"Please login...\";\n\nconst onClick = () => {\n  Near.call(\n    \"hello.near-examples.testnet\",\n    \"set_greeting\",\n    { greeting: \"Hello!\" }\n  );\n};\n\nreturn <>\n  <h5> Hello {context.accountId} </h5>\n  <button onClick={onClick}> Set Greeting </button>\n</>;\n```\n</WidgetEditor>","metadata":{"loc":{"lines":{"from":94,"to":116}}}}],["177",{"pageContent":"<details markdown=\"1\">\n<summary> Parameters </summary>","metadata":{"loc":{"lines":{"from":118,"to":119}}}}],["178",{"pageContent":"| param          | required     | type            | description                                                                 |\n|----------------|--------------|-----------------|-----------------------------------------------------------------------------|\n| `contractName` | **required** | string          | Name of the smart contract to call                                          |","metadata":{"loc":{"lines":{"from":121,"to":123}}}}],["179",{"pageContent":"| `methodName`   | **required** | string          | Name of the method to call on the smart contract                            |\n| `args`         | _optional_   | object instance | Arguments to pass to the smart contract method as an object instance        |\n| `gas`          | _optional_   | string / number | Maximum amount of gas to be used for the transaction (default 300Tg)        |","metadata":{"loc":{"lines":{"from":124,"to":126}}}}],["180",{"pageContent":"| `deposit`      | _optional_   | string / number | Amount of NEAR tokens to attach to the call as deposit (in yoctoNEAR units) |","metadata":{"loc":{"lines":{"from":127,"to":127}}}}],["181",{"pageContent":"</details>\n\n:::tip\nRemember that you can login using the `Login` button at the navigation bar.\n:::\n\n---","metadata":{"loc":{"lines":{"from":129,"to":135}}}}],["182",{"pageContent":"## Near.block\n\nQueries a block from the blockchain.\n\n<WidgetEditor height=\"40px\">\n\n```js\nreturn Near.block(\"optimistic\");","metadata":{"loc":{"lines":{"from":137,"to":144}}}}],["183",{"pageContent":"```\n\n</WidgetEditor>\n\n<details markdown=\"1\">\n<summary> Parameters </summary>","metadata":{"loc":{"lines":{"from":145,"to":150}}}}],["184",{"pageContent":"| param                   | required   | type | description                                                                                                                                       |\n|-------------------------|------------|------|---------------------------------------------------------------------------------------------------------------------------------------------------|","metadata":{"loc":{"lines":{"from":152,"to":153}}}}],["185",{"pageContent":"| `blockHeightOrFinality` | _optional_ | any  | The block height or finality level to use for the blockchain query (desired block height, or one of the following strings: `optimistic`, `final`) |","metadata":{"loc":{"lines":{"from":154,"to":154}}}}],["186",{"pageContent":"- desired block height: The height of the specific block to query, expressed as a positive integer\n- `optimistic`: Uses the latest block recorded on the node that responded to your query (< 1 second delay)\n- `final`: a block that has been validated on at least 66% of the nodes in the network (approx. 2s)\n\n</details>","metadata":{"loc":{"lines":{"from":156,"to":160}}}}],["187",{"pageContent":"---\nid: builtin-components\ntitle: List of Native Components\n---\n\nimport {WidgetEditor} from \"@site/src/components/widget-editor\"\n\nA list of all the built-in components to be used on Near Components.\n\n---","metadata":{"loc":{"lines":{"from":1,"to":10}}}}],["188",{"pageContent":"## Widget\n\nThe predefined component `Widget` allows you to include an existing component into your code, thus enabling to create complex applications by composing components.\n\n<WidgetEditor id='1' height=\"100px\">\n\n```ts\nconst props = { name: \"Anna\", amount: 3 };\n\nreturn <Widget src=\"influencer.testnet/widget/Greeter\" props={props} />;\n```\n\n</WidgetEditor>\n\n---","metadata":{"loc":{"lines":{"from":12,"to":26}}}}],["189",{"pageContent":"## IpfsImageUpload\n\nA built-in component that enables users to directly upload an image to the InterPlanetary File System (IPFS).\n\n<WidgetEditor id='2' height=\"200px\">\n\n```js\nState.init({image: {}})\n\nreturn <>\n  <p> Raw State: {JSON.stringify(state.image)} </p>\n  <IpfsImageUpload image={state.image} />\n</>\n```\n\n</WidgetEditor>\n\n---","metadata":{"loc":{"lines":{"from":28,"to":45}}}}],["190",{"pageContent":"## Files\n\nA built-in component that enables to input files with drag and drop support. Read more about the `Files` component [here](https://www.npmjs.com/package/react-files).\n\n<WidgetEditor id='3' height=\"220px\">\n\n```js\nconst [img, setImg] = useState(null);\nconst [msg, setMsg] = useState('Upload an Image')\n\nconst uploadFile = (files) => {\n  setMsg('Uploading...')","metadata":{"loc":{"lines":{"from":47,"to":58}}}}],["191",{"pageContent":"const file = fetch(\n    \"https://ipfs.near.social/add\",\n    {\n      method: \"POST\",\n      headers: { Accept: \"application/json\" },\n      body: files[0]\n    }\n  )\n\n  setImg(file.body.cid)\n  setMsg('Upload an Image')\n}\n\nreturn <>\n  <Files\n    multiple={false}\n    accepts={[\"image/*\"]}\n    clickable\n    className=\"btn btn-outline-primary\"\n    onChange={uploadFile}\n  >\n    {msg}\n  </Files>\n  {img ? <div><img src={`https://ipfs.near.social/ipfs/${img}`} /></div> : ''}\n</>;","metadata":{"loc":{"lines":{"from":60,"to":84}}}}],["192",{"pageContent":"```\n\n</WidgetEditor>\n\n---","metadata":{"loc":{"lines":{"from":85,"to":89}}}}],["193",{"pageContent":"## Markdown\n\nA component that enables to render Markdown.\n\n<WidgetEditor id='4' height=\"60px\">\n\n```jsx\nconst markdown = (`","metadata":{"loc":{"lines":{"from":91,"to":98}}}}],["194",{"pageContent":"## A title\n\nThis is some example **markdown** content, with _styled_ text\n`)\n\nreturn <Markdown text={markdown} />;\n```\n\n</WidgetEditor>\n\n:::tip Markdown Editor\n\nCheckout this [Markdown Editor](https://near.social/#/mob.near/widget/MarkdownEditorIframeExample), and [its source code](https://near.social/mob.near/widget/WidgetSource?src=mob.near/widget/MarkdownEditorIframeExample).\n:::\n\n---","metadata":{"loc":{"lines":{"from":99,"to":114}}}}],["195",{"pageContent":"## OverlayTrigger\n\nUsed to display a message or icon when the mouse is over a DOM element.\n\n<WidgetEditor id='5' height=\"200px\">\n\n```javascript\nconst [show, setShow] = useState(false);\n\nconst overlay = (\n  <div className='border m-3 p-3'>\n    This is the overlay Message\n  </div>\n);","metadata":{"loc":{"lines":{"from":116,"to":129}}}}],["196",{"pageContent":"return (\n  <OverlayTrigger\n    show={show}\n    delay={{ show: 250, hide: 300 }}\n    placement='auto'\n    overlay={overlay}\n  >\n    <button\n      className=\"btn btn-outline-primary\"\n      onMouseEnter={() => setShow(true)}\n      onMouseLeave={() => setShow(false)}\n    >\n      Place Mouse Over Me\n    </button>\n  </OverlayTrigger>\n);","metadata":{"loc":{"lines":{"from":131,"to":146}}}}],["197",{"pageContent":"```\n\n</WidgetEditor>\n\n<details markdown=\"1\">\n\n<summary> Component props </summary>\n\nThe OverlayTrigger component has several props that allow you to customize its behavior:","metadata":{"loc":{"lines":{"from":147,"to":155}}}}],["198",{"pageContent":"| Prop        | Description                                                                                                                                                                                                                                                                  |","metadata":{"loc":{"lines":{"from":157,"to":157}}}}],["199",{"pageContent":"|-------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|","metadata":{"loc":{"lines":{"from":158,"to":158}}}}],["200",{"pageContent":"| `show`      | A boolean value that determines whether the overlay is currently visible or not.                                                                                                                                                                                             |","metadata":{"loc":{"lines":{"from":159,"to":159}}}}],["201",{"pageContent":"| `trigger`   | An array of events that trigger the display of the overlay. In this example, the `trigger` prop is set to `[\"hover\", \"focus\"]`, which means that the overlay will be displayed when the user hovers over or focuses on the element.                                          |","metadata":{"loc":{"lines":{"from":160,"to":160}}}}],["202",{"pageContent":"| `delay`     | An object that specifies the delay before the overlay is displayed or hidden. In this example, the `delay` prop is set to `{ show: 250, hide: 300 }`, which means that the overlay will be displayed after a 250-millisecond delay and hidden after a 300-millisecond delay. |","metadata":{"loc":{"lines":{"from":161,"to":161}}}}],["203",{"pageContent":"| `placement` | A string that specifies the position of the overlay relative to the trigger element. In this example, the `placement` prop is set to `\"auto\"`, which means that the position will be automatically determined based on available space.                                      |","metadata":{"loc":{"lines":{"from":162,"to":162}}}}],["204",{"pageContent":"| `overlay`   | The content that will be displayed in the overlay. In this example, the `overlay` prop is set to a `<div>` element containing the message \"This is the overlay message.                                                                                                      |\n</details>","metadata":{"loc":{"lines":{"from":163,"to":164}}}}],["205",{"pageContent":"---","metadata":{"loc":{"lines":{"from":166,"to":166}}}}],["206",{"pageContent":"## InfiniteScroll\n\nInfinitely load a grid or list of items. This component allows you to create a simple, lightweight infinite scrolling page or element by supporting both window and scrollable elements.\n\nRead more about the [react-infinite-scroller](https://www.npmjs.com/package/react-infinite-scroller) package.\n\n<WidgetEditor id='6' height=\"200px\">","metadata":{"loc":{"lines":{"from":168,"to":174}}}}],["207",{"pageContent":"```js\nconst allNumbers = Array.from(Array(100).keys())\nconst [lastNumber, setLastNumber] = useState(0);\nconst [display, setDisplay] = useState([]);\n\nconst loadNumbers = (page) => {\n  const toDisplay = allNumbers\n    .slice(0, lastNumber + page*10)\n    .map(n => <p>{n}</p>)\n\n  console.log(lastNumber + page*10)\n  setDisplay(toDisplay);\n  setLastNumber(lastNumber + page*10);\n};","metadata":{"loc":{"lines":{"from":176,"to":189}}}}],["208",{"pageContent":"return (\n  <InfiniteScroll\n    loadMore={loadNumbers}\n    hasMore={lastNumber < allNumbers.length}\n    useWindow={false}\n  >\n    {display}\n  </InfiniteScroll>\n);","metadata":{"loc":{"lines":{"from":191,"to":199}}}}],["209",{"pageContent":"```\n\n</WidgetEditor>\n\n---","metadata":{"loc":{"lines":{"from":200,"to":204}}}}],["210",{"pageContent":"## TypeAhead\n\nProvides a type-ahead input field for selecting an option from a list of choices. More information about the component can be found [here](https://github.com/ericgio/react-bootstrap-typeahead).\n\n<WidgetEditor id='7' height=\"300px\">\n\n```jsx\nconst [selected, setSelected] = useState([]);\nconst options = [\"Apple\", \"Banana\", \"Cherry\", \"Durian\", \"Elderberry\"];","metadata":{"loc":{"lines":{"from":206,"to":214}}}}],["211",{"pageContent":"return <>\n  <Typeahead\n    options={options}\n    multiple\n    onChange={v => setSelected(v)}\n    placeholder='Choose a fruit...'\n  />\n  <hr />\n  <p> Selected: {selected.join(', ')} </p>\n</>;","metadata":{"loc":{"lines":{"from":216,"to":225}}}}],["212",{"pageContent":"```\n\n</WidgetEditor>\n\n---","metadata":{"loc":{"lines":{"from":226,"to":230}}}}],["213",{"pageContent":"## Styled Components\n\n[Styled Components](https://styled-components.com/) is a popular library for styling React components using CSS-in-JS.\n\n<WidgetEditor id='8' height=\"80px\">\n\n```jsx\nconst Button = styled.button`\n  /* Adapt the colors based on primary prop */\n  background: ${(props) => (props.primary ? \"palevioletred\" : \"white\")};\n  color: ${(props) => (props.primary ? \"white\" : \"palevioletred\")};","metadata":{"loc":{"lines":{"from":232,"to":242}}}}],["214",{"pageContent":"font-size: 1em;\n  margin: 1em;\n  padding: 0.25em 1em;\n  border: 2px solid palevioletred;\n  border-radius: 10px;\n`;\n\nreturn (\n  <div>\n    <Button>Normal</Button>\n    <Button primary>Primary</Button>\n  </div>\n);","metadata":{"loc":{"lines":{"from":244,"to":256}}}}],["215",{"pageContent":"```\n\n</WidgetEditor>\n\n---","metadata":{"loc":{"lines":{"from":257,"to":261}}}}],["216",{"pageContent":"## Tooltip\n\nDisplays a message once the mouse hovers over a particular item. This component was imported from [`React-Bootstrap`](https://react-bootstrap-v3.netlify.app/components/tooltips/).\n\n<WidgetEditor id='9' height=\"120px\">\n\n```js\nconst tooltip = (\n  <Tooltip id=\"tooltip\">\n    <strong>Holy guacamole!</strong> Check this info.\n  </Tooltip>\n);\n\nreturn <>\n  <OverlayTrigger placement=\"left\" overlay={tooltip}>\n    <button>Holy guacamole!</button>\n  </OverlayTrigger>","metadata":{"loc":{"lines":{"from":263,"to":279}}}}],["217",{"pageContent":"<OverlayTrigger placement=\"top\" overlay={tooltip}>\n    <button>Holy guacamole!</button>\n  </OverlayTrigger>\n\n  <OverlayTrigger placement=\"bottom\" overlay={tooltip}>\n    <button>Holy guacamole!</button>\n  </OverlayTrigger>\n\n  <OverlayTrigger placement=\"right\" overlay={tooltip}>\n    <button>Holy guacamole!</button>\n  </OverlayTrigger>\n</>","metadata":{"loc":{"lines":{"from":281,"to":292}}}}],["218",{"pageContent":"```\n\n</WidgetEditor>","metadata":{"loc":{"lines":{"from":293,"to":295}}}}],["219",{"pageContent":"---\nid: notifications\ntitle: Social Notifications\n---\nimport Tabs from '@theme/Tabs';\nimport TabItem from '@theme/TabItem';\nimport {WidgetEditor} from \"@site/src/components/widget-editor\"\n\nApplications such as [NEAR Social](https://near.social) and the [NEAR Dev Portal](https://dev.near.org/) allow components to send notifications to their users.","metadata":{"loc":{"lines":{"from":1,"to":9}}}}],["220",{"pageContent":"Notifications are great to inform users in real time that something has happened, and can be [easily incorporated into any web app](../tutorial/push-notifications.md).\n\n---","metadata":{"loc":{"lines":{"from":11,"to":13}}}}],["221",{"pageContent":"## Sending Notifications \n\nNotifications are implemented as a particular case of [indexed actions](./social.md#socialindex).\n\nThis means that to send a notification we just need to `index` the `notify` action for the indexer, with a `key` and a `value`.\n\n- The `key` tells **which account** to notify.\n- The `value` includes the [notification type](#notification-types) and the item being notified of.\n\n<WidgetEditor>","metadata":{"loc":{"lines":{"from":15,"to":24}}}}],["222",{"pageContent":"```js\nconst notifyMe = () => {\n  Social.set({\n    index: {\n      notify: JSON.stringify({\n        key: context.accountId,\n        value: \"docs notification\"\n      })\n    }\n  });\n}\n\nreturn <>\n  {context.accountId?\n  <button onClick={notifyMe}> Get Notification </button>\n  :\n  <p> Please login to be notified</p>\n  }\n</>","metadata":{"loc":{"lines":{"from":26,"to":44}}}}],["223",{"pageContent":"```\n\n</WidgetEditor>\n\n\nIn this example, the account executing the code is notifying `mob.near` that they liked their social post created at the block height `102169725`.\n\n---","metadata":{"loc":{"lines":{"from":45,"to":52}}}}],["224",{"pageContent":"## Notification Types\n\nSince notifications are indexed actions, anyone can create their own kind of notification.\n\nWhile there is no standard for notifications, we recommend using the following types:\n\n<Tabs>\n  <TabItem value=\"Custom\" default>","metadata":{"loc":{"lines":{"from":54,"to":61}}}}],["225",{"pageContent":"```js\n  Social.set({\n    index: JSON.stringify({\n      notify: {\n        key: \"mob.near\",\n        value: {\n          type: \"custom\",\n          message: \"A message in the notification\",\n          widget: \"The widget to open when clicking on the notification\",\n          params: { parameters: \"to pass to the widget\", ... },\n        },\n      }\n    })\n  });","metadata":{"loc":{"lines":{"from":63,"to":76}}}}],["226",{"pageContent":"```\n\n  **Note**: currently, only near.org implements custom notifications\n\n  </TabItem>\n\n  <TabItem value=\"Like\">\n\n  ```js\n  Social.set({\n    index: JSON.stringify({\n      notify: {\n        key: \"mob.near\",\n        value: {\n          type: \"like\",\n          item: {\n            type: \"social\",\n            path: \"mob.near/post/main\",\n            blockHeight: 102169725\n          }\n        }\n      }\n    })\n  })","metadata":{"loc":{"lines":{"from":77,"to":100}}}}],["227",{"pageContent":"```\n\n  **Reference**: [LikeButton](https://near.org/near/widget/ComponentDetailsPage?src=near/widget/LikeButton&tab=source)\n\n  </TabItem>\n  <TabItem value=\"Comment\">\n\n  ```js\n  Social.set({\n    index: JSON.stringify({\n      notify: {\n        key: \"nearhacks.near\",\n        value: {\n          type: \"comment\",\n          item: {\n            type: \"social\",\n            path: \"nearhacks.near/post/main\",\n            blockHeight: 102224773\n          }\n        }\n      }\n    })\n  })","metadata":{"loc":{"lines":{"from":101,"to":123}}}}],["228",{"pageContent":"```\n\n  **Reference**: [CommentButton](https://near.org/near/widget/ComponentDetailsPage?src=near/widget/Comments.Compose&tab=source)\n\n  </TabItem>\n    <TabItem value=\"Follow\">\n\n  ```js\n  Social.set({\n    index: JSON.stringify({\n      notify: {\n        key: \"mob.near\",\n        value: {\n          type: \"follow\",\n        }\n      }\n    })\n  })","metadata":{"loc":{"lines":{"from":124,"to":141}}}}],["229",{"pageContent":"```\n\n  **Reference**: [FollowButton](https://near.org/near/widget/ComponentDetailsPage?src=near/widget/FollowButton&tab=source)\n\n  </TabItem>\n\n</Tabs>\n\n:::caution\nThere is no standard for notifications, but you can contribute to create one [in this public discussion](https://github.com/NearSocial/standards/pull/19/files).\n:::\n\n---","metadata":{"loc":{"lines":{"from":142,"to":154}}}}],["230",{"pageContent":"## Parsing Notifications\n\nIn order to get all notifications for an user, we make a call to the Social indexer.\n\n<WidgetEditor id='1' height=\"190px\">\n\n```js\n// login to see your notifications\nconst accountId = context.accountId || 'influencer.testnet'\n\nconst index = Social.index(\"notify\", accountId, {limit: 2, order: \"desc\", subscribe: true});\n\nreturn <>\n  <h4> Notifications for {accountId} </h4>\n  {index.map(e => <> {JSON.stringify(e, null, 2)} <br/></>) }\n</>","metadata":{"loc":{"lines":{"from":156,"to":171}}}}],["231",{"pageContent":"```\n\n</WidgetEditor>\n\n:::caution\nPlease notice that anyone can create a notification for the user, and thus some form of filtering might be needed.\n:::\n\n:::tip\nYou can also check how the [Notifications Page](https://near.org/near/widget/ComponentDetailsPage?src=near/widget/NotificationsPage&tab=source) is implemented.\n:::","metadata":{"loc":{"lines":{"from":172,"to":182}}}}],["232",{"pageContent":"---\nid: primitives\ntitle: Primitives API\nsidebar_label: Primitives\n---\nimport Tabs from '@theme/Tabs';\nimport TabItem from '@theme/TabItem';\n\nNear Social VM provides a set of custom APIs that can be used by the components.\n\nStandard objects:\n- `JSON` - the JSON API.\n- `Object` - the Object API.\n- `Date`\n- `console` - the console API.\n- `Math` \n- `Array`\n- `Number`\n- `Buffer`\n- `Audio`\n- `Image`\n- `File`\n- `Blob`\n- `FileReader`\n- `URL`\n- `Uint8Array`\n- `Map`\n- `Set`","metadata":{"loc":{"lines":{"from":1,"to":28}}}}],["233",{"pageContent":"Imported objects:\n- `Big` - the big number API from the `big.js` library.\n- `BN` - the big number API from the `bn.js` library.","metadata":{"loc":{"lines":{"from":30,"to":32}}}}],["234",{"pageContent":"---\nid: social\ntitle: Social Interactions\n---\n\nimport {WidgetEditor} from \"@site/src/components/widget-editor\"\n\nNEAR components can natively communicate with the [SocialDB smart contract](https://github.com/NearSocial/social-db) (currently deployed at [social.near](https://nearblocks.io/address/social.near)).\n\nThe `SocialDB` is a contract that stores `key-value` pairs, and is used mostly to store social-related data, such as `posts`, `likes`, or `profiles`.","metadata":{"loc":{"lines":{"from":1,"to":10}}}}],["235",{"pageContent":":::tip\nBesides user data, the `SocialDB` contract stores **all existing NEAR components**.\n:::\n\n---","metadata":{"loc":{"lines":{"from":12,"to":16}}}}],["236",{"pageContent":"## Social.get\n\n`Social.get` queries a key from the SocialDB contract and returns the data. The key being queried can contain wildcards.\n\nFor example:\n\n  - `alice.near/profile/**`  will match the entire profile data of account alice.near.\n  - `alice.near/profile/*` will match all the fields of the profile, but not the nested objects.\n  - `alice.near/profile/name` will match only the name field of the profile.\n  - `*/widget/*` will match all the widgets of all the accounts.\n\n<br />","metadata":{"loc":{"lines":{"from":18,"to":29}}}}],["237",{"pageContent":"<WidgetEditor>\n\n```js\n// Ask for the `profile` key of the influencer.testnet account\nconst profile = Social.get(\"influencer.testnet/profile/*\");\n\n// Ask a component from the influencer.testnet account\nconst widget = Social.get(\"influencer.testnet/widget/Greeter\");\n\nif(profile === null || widget === null) return \"Loading ...\"\n\nreturn (\n  <div>\n    <p>Profile: {JSON.stringify(profile)}</p>\n    <p>Widgets: {JSON.stringify(widget)} </p>\n  </div>\n);","metadata":{"loc":{"lines":{"from":31,"to":47}}}}],["238",{"pageContent":"```\n\n</WidgetEditor>\n\n\n<details markdown=\"1\">\n<summary> Parameters </summary>\n\n| param      | required     | type               | description                  |\n|------------|--------------|--------------------|------------------------------|\n| `patterns` | **required** | string / string[]  | the path pattern(s)          |\n| `finality` | _optional_   | `\"final\"` / number | the block height or finality |\n| `options`  | _optional_   | object             | the `options` object.        |","metadata":{"loc":{"lines":{"from":48,"to":60}}}}],["239",{"pageContent":":::info options object\n\n- `subscribe` _(optional)_: if true, the data will be refreshed every 5 seconds.\n- `return_deleted` _(optional)_: whether to return deleted values (as `null`). Default is `false`.\n\n:::\n\nThe block height or finality can be used to get the data at a specific block height or finality.\nIf the block height or finality is not specified, the data will be fetched at the `optimistic` finality (the latest block height).","metadata":{"loc":{"lines":{"from":62,"to":70}}}}],["240",{"pageContent":"For block height and finality `final`, instead of calling the NEAR RPC directly, the VM uses the Social API Server to fetch the data.\n\nSocial API server indexes the data for SocialDB and allows to fetch the data at any block height with additional options.\n\nIt also allows returning more data than an RPC call because it's not restricted by the gas limit.\nIn general, the API server also serves data faster than the NEAR RPC, because it doesn't execute the contract code in a virtual machine.","metadata":{"loc":{"lines":{"from":72,"to":77}}}}],["241",{"pageContent":"</details>\n\n:::tip\nWhile the data is fetching, `Social.get` returns `null`.\n:::\n\n\n---","metadata":{"loc":{"lines":{"from":79,"to":86}}}}],["242",{"pageContent":"## Social.getr\n`Social.getr` is just a wrapper helper for `Social.get`, it appends `**` to each of the path pattern.\n\n<WidgetEditor>\n\n```js\nconst profile = Social.getr(\"influencer.testnet/profile\");\n\nreturn (\n  <div>\n    <p>Profile: {JSON.stringify(profile)}</p>\n  </div>\n);","metadata":{"loc":{"lines":{"from":88,"to":100}}}}],["243",{"pageContent":"```\n\n</WidgetEditor>\n\n<details markdown=\"1\">\n<summary> Parameters </summary>\n\n| param      | required     | type               | description                  |\n|------------|--------------|--------------------|------------------------------|\n| `patterns` | **required** | string / string[]  | the path pattern(s)          |\n| `finality` | _optional_   | `\"final\"` / number | the block height or finality |\n| `options`  | _optional_   | object             | the `options` object.        |","metadata":{"loc":{"lines":{"from":101,"to":112}}}}],["244",{"pageContent":":::info options object\n\n- `subscribe` _(optional)_: if true, the data will be refreshed every 5 seconds.\n- `return_deleted` _(optional)_: whether to return deleted values (as `null`). Default is `false`.\n\n:::\n\n</details>\n\n---","metadata":{"loc":{"lines":{"from":114,"to":123}}}}],["245",{"pageContent":"## Social.keys\n\nThe `keys` method allows to get the list of keys that match a pattern. It's useful for querying the data without reading values.\n\nIt also has an additional `options` field that can be used to specify the return type and whether to return deleted keys.\n\n<WidgetEditor height=\"80\">\n\n```js\nconst data = Social.keys(`influencer.testnet/profile/*`, \"final\");\n\nreturn JSON.stringify(data)","metadata":{"loc":{"lines":{"from":125,"to":136}}}}],["246",{"pageContent":"```\n\n</WidgetEditor>\n\n<details markdown=\"1\">\n<summary> Parameters </summary>\n\n`Social.keys` takes up to 3 arguments:","metadata":{"loc":{"lines":{"from":137,"to":144}}}}],["247",{"pageContent":"| param      | required     | type               | description                  |\n|------------|--------------|--------------------|------------------------------|\n| `patterns` | **required** | string / string[]  | the path pattern(s)          |\n| `finality` | _optional_   | `\"final\"` / number | the block height or finality |\n| `options`  | _optional_   | object             | the `options` object.        |\n\n:::info options object","metadata":{"loc":{"lines":{"from":146,"to":152}}}}],["248",{"pageContent":"- `subscribe` _(optional)_: if true, the data will be refreshed every 5 seconds.\n- `return_type` _(optional)_: either `\"History\"`, `\"True\"`, or `\"BlockHeight\"`. If not specified, it will return the `\"True\"`.\n- `return_deleted` _(optional)_: whether to return deleted values (as `null`). Default is `false`.\n- `values_only` _(optional)_: whether to return only values (don't include objects). Default is `false`.\n\n:::\n\n</details>","metadata":{"loc":{"lines":{"from":154,"to":161}}}}],["249",{"pageContent":":::tip\nThe Social API server supports custom options `return_type: \"History\"`. For each matching key, it will return an array containing all the block heights when the value was changed in ascending order.\nIt can be used for building a feed, where the values are overwritten. \n:::\n\n---","metadata":{"loc":{"lines":{"from":163,"to":168}}}}],["250",{"pageContent":"## Social.set\n\nTakes a `data` object and commits it to SocialDB. The data object can contain multiple keys, and each key can contain multiple values.\n\nImportantly, a user can only commit to **their own** space in `SocialDB` (e.g. `alice.near` can only write in `alice.near/**`), except if [**given explicit permission**](https://github.com/NearSocial/social-db#permissions) by the owner of another space.","metadata":{"loc":{"lines":{"from":170,"to":174}}}}],["251",{"pageContent":"Each time a user wants to commit data, they will be prompted to confirm the action. On confirming, the user can choose to not be asked again in the future.\n\n<WidgetEditor>\n\n```js\nconst onClick = () => {\n  Social.set({\n    post: {\n      main: JSON.stringify({\n        type: \"md\",\n        text: \"I've read the docs!\"\n      })\n    }\n  })\n}\n\nif(!context.accountId) return \"Please login...\";","metadata":{"loc":{"lines":{"from":176,"to":192}}}}],["252",{"pageContent":"return <>\n  <p> Save a message showing some love to the NEAR Docs </p>\n  <button onClick={onClick}> Save the Message </button>\n</>","metadata":{"loc":{"lines":{"from":194,"to":197}}}}],["253",{"pageContent":"```\n\n</WidgetEditor>\n\n<details markdown=\"1\">\n<summary> Parameters </summary>\n\n`Social.set` arguments:","metadata":{"loc":{"lines":{"from":198,"to":205}}}}],["254",{"pageContent":"| param     | required     | type   | description                                                                                        |\n |-----------|--------------|--------|----------------------------------------------------------------------------------------------------|\n | `data`    | **required** | object | the data object to be committed. Similar to `CommitButton`, it shouldn't start with an account ID. |","metadata":{"loc":{"lines":{"from":207,"to":209}}}}],["255",{"pageContent":"| `options` | _optional_   | object | optional object.                                                                                   |","metadata":{"loc":{"lines":{"from":210,"to":210}}}}],["256",{"pageContent":":::info options object\n\n- `force` _(optional)_: whether to overwrite the data.\n- `onCommit` _(optional)_: function to trigger on successful commit. Will pass the\ndata that was written (including `accountID`).\n- `onCancel` _(optional)_: function to trigger if the user cancels the commit.\n\n:::\n\n</details>","metadata":{"loc":{"lines":{"from":212,"to":221}}}}],["257",{"pageContent":":::tip\nBy default `Social.set` will omit saving data that is already saved (e.g. if the user already liked a post, it won't save the like again). To force saving the data, pass the `force` option.\n:::\n\n---","metadata":{"loc":{"lines":{"from":223,"to":227}}}}],["258",{"pageContent":"## Social.index\nNEAR Social readily provides an indexer - a service that listen to actions in SocialDB, and caches them so they can be retrieved without needing to interact with the contract.\n\nThe indexer is very useful, for example, to rapidly store and retrieve information on all comments for a post. Without the indexer, we would need to check all entries in the contract to see who answered, surely running out of GAS before completion.\n\n<hr className=\"subsection\" />","metadata":{"loc":{"lines":{"from":229,"to":234}}}}],["259",{"pageContent":"### Indexing an Action\nTo index an action we need to add the `index` key to the data being saved, within the `index` key we will save the `action` being indexed, alongside a `key` and a `value` that identifies this specific instance.\n\n<WidgetEditor>\n\n```js\n// General form of an indexed action\n// {\n//   index: {\n//     actionName: JSON.stringify({ key, value })\n//   }\n// }","metadata":{"loc":{"lines":{"from":236,"to":247}}}}],["260",{"pageContent":"const onClick = () => {\n  Social.set({\n    index: {\n      readDocs: JSON.stringify({key: \"docs\", value: \"like\"})\n    } ,\n  })\n}\n\nreturn <>\n  {context.accountId ?\n  <>\n    <p> Index an action showing some love to the NEAR Docs </p>\n    <button onClick={onClick}> Index Action </button>\n  </> :\n  <p> Login to index an action </p>}\n</>","metadata":{"loc":{"lines":{"from":249,"to":264}}}}],["261",{"pageContent":"```\n\n</WidgetEditor>\n\nIn the example above we index a `docs` action. In this case the `action` is `docs`, and the `key` that identifies it is `\"read\"`.\n\n<details markdown=\"1\">\n\n<summary> Standards </summary>","metadata":{"loc":{"lines":{"from":265,"to":273}}}}],["262",{"pageContent":"#### Indexing a Post\nTo index a post, the standard is to save the action `post`, with `{key: \"main\", value: {type: \"md\"}`.\n\n```js\n{\n  index: {\n    post: JSON.stringify({\n      key: \"main\",\n      value: {type: \"md\"}\n    })\n  }\n}\n```","metadata":{"loc":{"lines":{"from":275,"to":287}}}}],["263",{"pageContent":"#### Indexing a Like\nTo index a like, the standard is to save the action `like`, with `{key: object-representing-the-post, value: {type: \"like\" }}`\n\n```js\n{\n  index: {\n    like: JSON.stringify({\n      key: {type: 'social', path: 'influencer.testnet/post/main', blockHeight: 152959480 },\n      value: {type: \"like\"}})\n  }\n}\n```\n\n</details>\n\n<hr className=\"subsection\" />","metadata":{"loc":{"lines":{"from":289,"to":304}}}}],["264",{"pageContent":"### Retrieving Indexed Actions\n\nTo retrieve indexed actions we use the `Social.index` method. It takes the `action` and the `key` as arguments, and returns an array of all the indexed values alongside the `blockHeight` in which they were indexed, and which user made the action.\n\n\n<WidgetEditor>\n\n```js\nconst readDocs = Social.index(\"readDocs\", \"docs\")\n\nreturn <>\n  <p> Number of indexed \"readDocs\" actions with key \"docs\": {readDocs.length} </p>","metadata":{"loc":{"lines":{"from":306,"to":317}}}}],["265",{"pageContent":"<b>Indexed actions</b>\n  {JSON.stringify(readDocs)}\n</>","metadata":{"loc":{"lines":{"from":319,"to":321}}}}],["266",{"pageContent":"```\n\n</WidgetEditor>\n\n\n<details markdown=\"1\">\n<summary> Parameters </summary>\n\n`Social.index` arguments:","metadata":{"loc":{"lines":{"from":322,"to":330}}}}],["267",{"pageContent":"| param     | required     | type   | description                                                                                |\n |-----------|--------------|--------|--------------------------------------------------------------------------------------------|\n | `action`  | **required** | string | is the `index_type` from the standard, e.g. in the path `index/like` the action is `like`. |","metadata":{"loc":{"lines":{"from":332,"to":334}}}}],["268",{"pageContent":"| `key`     | **required** | string | is the inner indexed value from the standard.                                              |\n | `options` | _optional_   | object | the `options` object.                                                                      |","metadata":{"loc":{"lines":{"from":335,"to":336}}}}],["269",{"pageContent":":::info options object","metadata":{"loc":{"lines":{"from":338,"to":338}}}}],["270",{"pageContent":"- `subscribe` _(optional)_: if true, the data will be refreshed every 5 seconds.\n- `accountId` _(optional)_: If given, it should either be a string or an array of account IDs to filter values by them. Otherwise, not filters by account Id.\n- `order` _(optional)_: Either `asc` or `desc`. Defaults to `asc`.\n- `limit` _(optional)_: Defaults to `100`. The number of values to return. Index may return more than index values, if the last elements have the same block height.","metadata":{"loc":{"lines":{"from":340,"to":343}}}}],["271",{"pageContent":"- `from` _(optional)_: Defaults to `0` or `Max` depending on order.","metadata":{"loc":{"lines":{"from":344,"to":344}}}}],["272",{"pageContent":":::\n\n</details>","metadata":{"loc":{"lines":{"from":346,"to":348}}}}],["273",{"pageContent":"---\nid: state\ntitle: Basics\n---\nimport Tabs from '@theme/Tabs';\nimport TabItem from '@theme/TabItem';\nimport {WidgetEditor} from \"@site/src/components/widget-editor\"\n\nBorrowing from React, Near Components use hooks such as [**`useState`**](#state) and [**`useEffect`**](#useeffect-hook) to handle the state's logic, and [**props**](#props) to receive parameters.","metadata":{"loc":{"lines":{"from":1,"to":9}}}}],["274",{"pageContent":"Near Components are stored in the blockchain, for which you will use the `NEAR VM` to [retrieve and execute them in the browser](../../2.develop/integrate/frontend-components.md).\n\nUsing a VM enforces components to be sandboxed, making them very secure since they cannot access your `LocalStorage` or other elements in the page they are incorporated to. However, because of this, components cannot import external libraries. However, they can [**import functions**](#import) from other components.","metadata":{"loc":{"lines":{"from":11,"to":13}}}}],["275",{"pageContent":"---","metadata":{"loc":{"lines":{"from":15,"to":15}}}}],["276",{"pageContent":"## State\nTo handle the component's state you can use `useState` hook. The `useState` hook returns a tuple of two values: the current state and a function that updates it.\n\n<WidgetEditor>\n\n```jsx\nconst [count, setCount] = useState(0);\n\nreturn (\n  <div>\n    <p>You clicked {count} times</p>\n    <button onClick={() => setCount(count + 1)}>Click me</button>\n  </div>\n);","metadata":{"loc":{"lines":{"from":17,"to":30}}}}],["277",{"pageContent":"```\n\n</WidgetEditor>\n\nEach time a state variable is updated, the component will be **re-rendered**. This means that the **whole code will run again**.\n\n---","metadata":{"loc":{"lines":{"from":32,"to":38}}}}],["278",{"pageContent":"## Props\nEach component has access to a local variable named `props` which holds the properties received as input when the component is composed.\n\n<WidgetEditor id='2'>\n\n```jsx\nreturn <>\n  <p> This component props: {JSON.stringify(props)} </p>\n  <Widget src=\"influencer.testnet/widget/Greeter\" \n          props={{name: \"Maria\", amount: 2}} />\n</>\n```\n\n</WidgetEditor>\n\n---","metadata":{"loc":{"lines":{"from":40,"to":55}}}}],["279",{"pageContent":"## useEffect Hook\n\nThe [`useEffect` hook](https://react.dev/learn/synchronizing-with-effects) is used to handle side effects. It will execute each time one of the dependencies changes.\n\n<WidgetEditor id='3'>\n\n```jsx\nconst [count, setCount] = useState(0);\nconst [visible, setVisible] = useState(false);\n\nuseEffect(() => {\n  if(count > 5) setVisible(true);\n}, [count]);","metadata":{"loc":{"lines":{"from":57,"to":69}}}}],["280",{"pageContent":"return (\n  <div>\n    <p>You clicked {count} times</p>\n    <p className=\"alert alert-danger\" hidden={!visible}>\n      You clicked more than 5 times\n    </p>\n    <button onClick={() => setCount(count + 1)}>Click me</button>\n  </div>\n);  \n```\n</WidgetEditor>\n\n---","metadata":{"loc":{"lines":{"from":71,"to":83}}}}],["281",{"pageContent":"## Import\n\nComponents can import functions from other components. This is useful to reuse code and to create libraries of components.\n\n<WidgetEditor id='4'>\n\n```jsx\nconst {add, multiply} = VM.require('influencer.testnet/widget/Math');\n\nreturn <>\n  <p> 2 + 3 = {add(2, 3)} </p>\n  <p> 2 * 3 = {multiply(2, 3)} </p>\n</>","metadata":{"loc":{"lines":{"from":85,"to":97}}}}],["282",{"pageContent":"```\n\n</WidgetEditor>\n\nWhere the code of the `Math` component is:\n\n```js\nfunction add(a, b) {\n  return a + b;\n}\n\nfunction multiply(a, b) {\n  return a * b;\n}\n\nreturn { add, multiply };\n```","metadata":{"loc":{"lines":{"from":98,"to":114}}}}],["283",{"pageContent":"---\nid: web-methods\ntitle: Web Browser Methods\n---\n\nimport {WidgetEditor} from \"@site/src/components/widget-editor\"\n\nNEAR Components have access to classic web methods that enable them to:\n- [Fetch](#fetch) data from external sources.\n- [Cache](#cache) values to avoid redundant computations.\n- Use [LocalStorage](#localstorage) to store data in the web browser.\n- Access to the [Clipboard](#clipboard).\n\n---","metadata":{"loc":{"lines":{"from":1,"to":14}}}}],["284",{"pageContent":"## Fetch\n\n`fetch` allows to fetch data from the URL. It acts like a hook. It's a wrapper around the `fetch` function from the browser behind the caching layer. \n\nThe possible returned values are:\n- If the data is not cached, it returns `null` and fetches the data in the background.\n- If the data is cached, it returns the cached value and then revalidates it.\n\n<WidgetEditor height=\"80\">\n\n```js\nconst res = fetch(\"https://rpc.mainnet.near.org/status\");\n\nreturn res.body;","metadata":{"loc":{"lines":{"from":16,"to":29}}}}],["285",{"pageContent":"```\n\n</WidgetEditor>\n\n<hr className=\"subsection\" />","metadata":{"loc":{"lines":{"from":30,"to":34}}}}],["286",{"pageContent":"#### Async Version\n\n`asyncFetch` is the `async` version of [`fetch`](#fetch), meaning that it returns a promise instead of a value.\n\n<WidgetEditor height=\"80\">\n\n```js\nconst [uptime, setUptime] = useState(null);\n\nfunction reportUptime() {\n  const promise = asyncFetch(\"https://rpc.mainnet.near.org/status\")\n  \n  promise.then(\n    res => { setUptime(res.body.uptime_sec) }\n  );\n}","metadata":{"loc":{"lines":{"from":36,"to":51}}}}],["287",{"pageContent":"return <>\n  <p> {uptime? `Uptime: ${uptime}s` : `Fetch a value` } </p>\n  <button onClick={reportUptime}>Fetch uptime</button>\n</>","metadata":{"loc":{"lines":{"from":53,"to":56}}}}],["288",{"pageContent":"```\n\n</WidgetEditor>\n\n:::tip\nIn contrast with `fetch`, `asyncFetch` does **not** cache the resulting value, so it should only be used within a function to avoid frequent requests on every render.\n:::\n\n---","metadata":{"loc":{"lines":{"from":57,"to":65}}}}],["289",{"pageContent":"## Cache\n\nThe `useCache` hook takes a promise through a generator function, fetches the data and caches it. It can be used to easily use and cache data from async data sources.\n\nThe cache is global for the VM, but each cached element is identified by a unique `dataKey` within each component. \n\nThe possible values returned are:\n- `null` if the cache is cold and data is fetching\n- the `cached value` while the data is being fetched \n- A new `value` if new data is fetched.\n\n<WidgetEditor>","metadata":{"loc":{"lines":{"from":67,"to":78}}}}],["290",{"pageContent":"```js\nconst status = useCache(\n  () =>\n    asyncFetch(\"https://rpc.mainnet.near.org/status\").then((res) => res.body),\n  \"mainnetRpcStatus\",\n  { subscribe: true }\n);\n\nreturn status;","metadata":{"loc":{"lines":{"from":80,"to":88}}}}],["291",{"pageContent":"```\n\n</WidgetEditor>\n\n<details markdown=\"1\">\n<summary> Parameters </summary>","metadata":{"loc":{"lines":{"from":89,"to":94}}}}],["292",{"pageContent":"| param              | required     | type   | description                                                          |\n|--------------------|--------------|--------|----------------------------------------------------------------------|\n| `promiseGenerator` | **required** | object | a function that returns a promise, which generates data.             |\n| `dataKey`          | **required** | object | the unique name (within the current component) to identify the data. |","metadata":{"loc":{"lines":{"from":96,"to":99}}}}],["293",{"pageContent":"| `options`          | _optional_   | object | optional argument.                                                   |","metadata":{"loc":{"lines":{"from":100,"to":100}}}}],["294",{"pageContent":":::info options object\n\n- `subscribe` _(optional)_: if `true`, the data refreshes periodically by invalidating cache.\n\n:::\n\n:::note\n- `promiseGenerator`: you don't return the promise directly, because it should only be fired once.\n:::\n\n</details>\n\n:::tip\nThe [fetch](#fetch) method is built on top of the `useCache` hook.\n:::\n\n:::note\nThe data is being cached and compared as JSON serialized objects.\n:::\n\n---","metadata":{"loc":{"lines":{"from":102,"to":122}}}}],["295",{"pageContent":"## LocalStorage\n\nNEAR Components have access to a simulated `localStorage` through the `Storage` object:\n\n- [`Storage.get`](#storageget)\n- [`Storage.set`](#storageset)\n- [`Storage.privateGet`](#storageprivateget)\n- [`Storage.privateSet`](#storageprivateset)\n\n<WidgetEditor>\n\n```jsx\nconst [time, setTime] = useState(stored || Date.now()) \n\nconst storeValue = () => {\n  const date = Date.now();\n  Storage.set('time_now', date)\n}","metadata":{"loc":{"lines":{"from":124,"to":141}}}}],["296",{"pageContent":"return <>\n  <p> Time Now: {Date.now()} </p>\n  <p> Time Stored: {Storage.get('time_now')} </p>\n  <button onClick={storeValue}>Store Date.now()</button>\n</>","metadata":{"loc":{"lines":{"from":143,"to":147}}}}],["297",{"pageContent":"```\n\n</WidgetEditor>\n\n<details markdown=\"1\">\n<summary> Parameters </summary>","metadata":{"loc":{"lines":{"from":148,"to":153}}}}],["298",{"pageContent":"#### Storage.get\n\n`Storage.get(key, widgetSrc?)` - returns the public value for a given key under the given widgetSrc or the current component if `widgetSrc` is omitted. Can only read public values.\n\n | param       | required     | type   | description              |\n |-------------|--------------|--------|--------------------------|\n | `key`       | **required** | object | a user-defined key       |\n | `widgetSrc` | _optional_   | object | a user-defined component |\n\n---","metadata":{"loc":{"lines":{"from":155,"to":164}}}}],["299",{"pageContent":"#### Storage.set\n\n`Storage.set(key, value)` - sets the public value for a given key under the current widget. The value will be public, so other widgets can read it.\n\n | param   | required     | type   | description          |\n |---------|--------------|--------|----------------------|\n | `key`   | **required** | object | a user-defined key   |\n | `value` | **required** | object | a user-defined value |\n\n---","metadata":{"loc":{"lines":{"from":166,"to":175}}}}],["300",{"pageContent":"#### Storage.privateGet\n\n`Storage.privateGet(key)` - returns the private value for a given key under the current component.\n\n | param | required     | type   | description                                    |\n |-------|--------------|--------|------------------------------------------------|\n | `key` | **required** | object | a user-defined key under the current component |\n\n---","metadata":{"loc":{"lines":{"from":177,"to":185}}}}],["301",{"pageContent":"#### Storage.privateSet\n\n`Storage.privateSet(key, value)` - sets the private value for a given key under the current component. The value is private, only the current component can read it.\n\n:::note\nPrivate and public values can share the same key and don't conflict.\n:::","metadata":{"loc":{"lines":{"from":187,"to":193}}}}],["302",{"pageContent":"| param   | required     | type   | description                                    |\n |---------|--------------|--------|------------------------------------------------|\n | `key`   | **required** | object | a user-defined key under the current component |\n | `value` | **required** | object | a user-defined value                           |\n\n</details>\n\n---","metadata":{"loc":{"lines":{"from":195,"to":202}}}}],["303",{"pageContent":"## Clipboard\n\nNEAR Components can **write** data to the system's clipboard through the `clipboard.writeText` method.\n\nWriting to the clipboard is **only** allowed in **trusted actions**, for example, when the user clicks a button.\n\n<WidgetEditor>\n\n```js\nconst copyToClipboard = (test) => { clipboard.writeText(\"Hello World!\") }\n\nreturn <>\n    <button onClick={copyToClipboard}> Copy </button>\n    <textarea className=\"form-control mt-2\" placeholder=\"Test pasting here\" />\n</>\n```\n\n</WidgetEditor>","metadata":{"loc":{"lines":{"from":204,"to":221}}}}]]